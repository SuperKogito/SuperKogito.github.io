
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Loop over monitors and get their coordinates and dimensions in C++ when using a multiple monitors setup on windows." name="description" />
<meta content="multiple monitors setup, multi-monitors, monitors dimensions, C++, monitor coordinates" name="keywords" />
<meta content="Ayoub Malek" name="author" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-133660046-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>How to loop over monitors and get their coordinates on Windows in C++? &#8212; Ayoub Malek&#39;s blog</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_style.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
  
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          

          <div class="body" role="main">
            <!-- START Bootstrap-Cookie-Alert -->
            <div class="alert text-center cookiealert" role="alert">
                <div class="cookiesContainer">
                  <b>
                    We use cookies and other technologies to perform analytics and deliver a better user experience.
                    By clicking “I agree” below, you consent to the use by us and our third-party partners of cookies and data gathered from your use of this website.
                    See our <a href="https://cookiesandyou.com/" target="_blank">Privacy Policy</a> and <a href="https://cookiesandyou.com/" target="_blank">Third Party Partners</a> to learn more about the use of data and your rights.
                    You also agree to our <a href="https://cookiesandyou.com/" target="_blank">Terms of Service</a>.
                </b>
                <button type="button" class="btn btn-primary btn-sm acceptcookies">
                    I agree
                </button>
              </div>
            </div>
            <!-- END Bootstrap-Cookie-Alert -->

             <section id="how-to-loop-over-monitors-and-get-their-coordinates-on-windows-in-c">
<h1>How to loop over monitors and get their coordinates on Windows in C++?<a class="headerlink" href="#how-to-loop-over-monitors-and-get-their-coordinates-on-windows-in-c" title="Permalink to this headline">¶</a></h1>
<div class="blog-post-tags">
  <ul class="blog-posts-details">
  <li id="Date"><span>Date:</span>                 28 September 2020 </li>
  <li id="author"><span>Author:</span>            <a href="author/ayoub-malek.html">Ayoub Malek</a> </li>
  <li id="location"><span>Location:</span>        <a href="location/munich.html">Munich</a>
  </li>  <li id="language"><span>Language:</span> <a href="language/english.html">English</a>
  </li>  <li id="category"><span>Category:</span> <a href="category/image-processing.html">Image processing</a>
  </li>
  <li id="tags"><span>Tags:
        </span>
        <a class="post-tags" href="tag/cplusplus.html">C++</a>
        <a class="post-tags" href="tag/windows.html">Windows</a>
  </li>
  </ul>
</div><hr class="docutils" />
<p>The previous three blogs (<a class="reference external" href="https://superkogito.github.io/blog/CaptureScreenUsingOpenCv.html">Capturing the screen on Windows in C++ using OpenCV</a> &amp; <a class="reference external" href="https://superkogito.github.io/blog/CaptureScreenUsingGdiplus.html">Capturing the screen on Windows in C++ using GDI+</a> and <a class="reference external" href="https://superkogito.github.io/blog/CaptureSceenshotUsingGdiplusVSCaptureSceenshotUsingOpenCV.html">Comparing screen capturing using GDI+ and OpenCV on Windows in C++</a>) described capturing a screenshot of only <em>one</em> monitor.
However, nowadays we often use multiple monitors and capturing the content of all of them or a specific one, two or more.
Therefore, we will need to retrieve the coordinates of the targeted monitors.
This blog will provide a short explanation and a C++ implementation for how to loop the existing monitors in a multiple monitors setup, get their dimensions and coordinates which can be used later into capturing the monitors content.</p>
<div class="line-block">
<div class="line"><strong>*Keywords*</strong>:  multiple monitors, multi-monitors dimensions, monitor coordinates, C++</div>
</div>
<section id="approach-and-implementation">
<h2>Approach and implementation<a class="headerlink" href="#approach-and-implementation" title="Permalink to this headline">¶</a></h2>
<p>The trick for looping the screens dimensions is to use the function <code class="code docutils literal notranslate"><span class="pre">EnumDisplayMonitors(NULL,</span> <span class="pre">NULL,</span> <span class="pre">MyInfoEnumProc,</span> <span class="pre">0)</span></code>, which is available as part of the <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/">Win32 API</a>.
A nice approach to this, is to pack the enumeration code in a structure that can be looped to retrieve the information related to each monitor.
This can be done as in the following:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;windows.h&gt;</span><span class="cp"></span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span><span class="cp"></span>
<span class="linenos"> 3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1">// Structure that includes all screen hanldes and rectangles</span>
<span class="linenos"> 7</span><span class="k">struct</span><span class="w"> </span><span class="nc">cMonitorsVec</span><span class="w"></span>
<span class="linenos"> 8</span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 9</span><span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w">       </span><span class="n">iMonitors</span><span class="p">;</span><span class="w"></span>
<span class="linenos">10</span><span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HMONITOR</span><span class="o">&gt;</span><span class="w">  </span><span class="n">hMonitors</span><span class="p">;</span><span class="w"></span>
<span class="linenos">11</span><span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">HDC</span><span class="o">&gt;</span><span class="w">       </span><span class="n">hdcMonitors</span><span class="p">;</span><span class="w"></span>
<span class="linenos">12</span><span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">RECT</span><span class="o">&gt;</span><span class="w">      </span><span class="n">rcMonitors</span><span class="p">;</span><span class="w"></span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="w">      </span><span class="k">static</span><span class="w"> </span><span class="n">BOOL</span><span class="w"> </span><span class="n">CALLBACK</span><span class="w"> </span><span class="n">MonitorEnum</span><span class="p">(</span><span class="n">HMONITOR</span><span class="w"> </span><span class="n">hMon</span><span class="p">,</span><span class="w"> </span><span class="n">HDC</span><span class="w"> </span><span class="n">hdc</span><span class="p">,</span><span class="w"> </span><span class="n">LPRECT</span><span class="w"> </span><span class="n">lprcMonitor</span><span class="p">,</span><span class="w"> </span><span class="n">LPARAM</span><span class="w"> </span><span class="n">pData</span><span class="p">)</span><span class="w"></span>
<span class="linenos">15</span><span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="linenos">16</span><span class="w">              </span><span class="n">cMonitorsVec</span><span class="o">*</span><span class="w"> </span><span class="n">pThis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">cMonitorsVec</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">pData</span><span class="p">);</span><span class="w"></span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="w">              </span><span class="n">pThis</span><span class="o">-&gt;</span><span class="n">hMonitors</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">hMon</span><span class="p">);</span><span class="w"></span>
<span class="linenos">19</span><span class="w">              </span><span class="n">pThis</span><span class="o">-&gt;</span><span class="n">hdcMonitors</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">hdc</span><span class="p">);</span><span class="w"></span>
<span class="linenos">20</span><span class="w">              </span><span class="n">pThis</span><span class="o">-&gt;</span><span class="n">rcMonitors</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">*</span><span class="n">lprcMonitor</span><span class="p">);</span><span class="w"></span>
<span class="linenos">21</span><span class="w">              </span><span class="n">pThis</span><span class="o">-&gt;</span><span class="n">iMonitors</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">pThis</span><span class="o">-&gt;</span><span class="n">hdcMonitors</span><span class="p">.</span><span class="n">size</span><span class="p">());</span><span class="w"></span>
<span class="linenos">22</span><span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span><span class="w"></span>
<span class="linenos">23</span><span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="w">      </span><span class="n">cMonitorsVec</span><span class="p">()</span><span class="w"></span>
<span class="linenos">26</span><span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="linenos">27</span><span class="w">              </span><span class="n">EnumDisplayMonitors</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MonitorEnum</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">LPARAM</span><span class="p">)</span><span class="k">this</span><span class="p">);</span><span class="w"></span>
<span class="linenos">28</span><span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="linenos">29</span><span class="p">};</span><span class="w"></span>
<span class="linenos">30</span>
<span class="linenos">31</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="linenos">34</span><span class="p">{</span><span class="w"></span>
<span class="linenos">35</span><span class="w">      </span><span class="n">cMonitorsVec</span><span class="w"> </span><span class="n">Monitors</span><span class="p">;</span><span class="w"></span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">monitorIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w">  </span><span class="n">monitorIndex</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Monitors</span><span class="p">.</span><span class="n">iMonitors</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">monitorIndex</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="linenos">38</span><span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="linenos">39</span><span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">wcout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Screen id: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">monitorIndex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">40</span><span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">wcout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;-----------------------------------------------------&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">41</span><span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">wcout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; - screen left-top corner coordinates : (&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Monitors</span><span class="p">.</span><span class="n">rcMonitors</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">].</span><span class="n">left</span><span class="w"></span>
<span class="linenos">42</span><span class="w">                                                                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">Monitors</span><span class="p">.</span><span class="n">rcMonitors</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">].</span><span class="n">top</span><span class="w"></span>
<span class="linenos">43</span><span class="w">                                                                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">44</span><span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">wcout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; - screen dimensions (width x height) : (&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">Monitors</span><span class="p">.</span><span class="n">rcMonitors</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">].</span><span class="n">right</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Monitors</span><span class="p">.</span><span class="n">rcMonitors</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">].</span><span class="n">left</span><span class="p">)</span><span class="w"></span>
<span class="linenos">45</span><span class="w">                                                                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">Monitors</span><span class="p">.</span><span class="n">rcMonitors</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">].</span><span class="n">top</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Monitors</span><span class="p">.</span><span class="n">rcMonitors</span><span class="p">[</span><span class="n">monitorIndex</span><span class="p">].</span><span class="n">bottom</span><span class="p">)</span><span class="w"></span>
<span class="linenos">46</span><span class="w">                                                                 </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">47</span><span class="w">              </span><span class="n">std</span><span class="o">::</span><span class="n">wcout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;-----------------------------------------------------&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">48</span><span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="linenos">49</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The previous code can be also found under <a class="reference external" href="https://gist.github.com/SuperKogito/c31c0c0f9e69e484a1740b67a207a5c1">here</a>.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This post introduced a small example of how to retrieve the coordinates and dimensions of the connected monitors using C++ on Windows in the case of a multi-monitors setup.
The retrieved coordinates can then be used in capturing the screens content using the snippets from the previous blogs  (<a class="reference external" href="https://superkogito.github.io/blog/CaptureScreenUsingOpenCv.html">Capturing the screen on Windows in C++ using OpenCV</a> &amp; <a class="reference external" href="https://superkogito.github.io/blog/CaptureScreenUsingGdiplus.html">Capturing the screen on Windows in C++ using GDI+</a>)</p>
</section>
<section id="references-and-further-readings">
<h2>References and Further readings<a class="headerlink" href="#references-and-further-readings" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id1"><span class="brackets">1</span></dt>
<dd><p>EnumDisplayMonitors function (winuser.h), Microsoft, <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-enumdisplaymonitors">https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-enumdisplaymonitors</a></p>
</dd>
<dt class="label" id="id2"><span class="brackets">2</span></dt>
<dd><p>Enumeration and Display Control, Microsoft, <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/gdi/enumeration-and-display-control">https://docs.microsoft.com/en-us/windows/win32/gdi/enumeration-and-display-control</a></p>
</dd>
<dt class="label" id="id3"><span class="brackets">3</span></dt>
<dd><p>Multi-monitor Screenshots only 2 monitors in C++ with WinApi, Stackoverflow, <a class="reference external" href="https://stackoverflow.com/questions/37132196/multi-monitor-screenshots-only-2-monitors-in-c-with-winapi">https://stackoverflow.com/questions/37132196/multi-monitor-screenshots-only-2-monitors-in-c-with-winapi</a></p>
</dd>
</dl>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
     Previous:
    
    <a href="CaptureSceenshotUsingGdiplusVSCaptureSceenshotUsingOpenCV.html">
       Comparing screen capturing using GDI+ and OpenCV on Windows in C++
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
     Next: 
    <a href="DivideImageUsingOpenCv.html">
      Divide an image into blocks using OpenCV in C++ 
    </a>
    
  </span>
</div>
  
</div>

          </div>
          
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019-2022, Ayoub Malek.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      | <a href="https://github.com/bitprophet/alabaster">Terms of Service</a>
      | <a href="https://github.com/bitprophet/alabaster">Privacy Policy</a>
      | <a href="https://github.com/bitprophet/alabaster">Impressum</a>

      
    </div>

    

    
    <!-- Include cookiealert script -->
    <script src="https://cdn.jsdelivr.net/gh/Wruczek/Bootstrap-Cookie-Alert@gh-pages/cookiealert.js"></script>
    <script src="_static/js/share-buttons.js"></script>
  </body>
</html>
<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="Authenticated Encryption post" name="description" />
<meta content="Authenticated Encryption, Encryption, Hashing, Security, Ayoub Malek, Cybersecurity" name="keywords" />
<meta content="Ayoub Malek" name="author" />

    <title>[01-04-2019] Authenticated encryption &mdash; Ayoub Malek&#39;s blog</title>
    <meta name="description" content="">
    <meta name="author" content="">

    
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Text+Me+One" media="screen and (min-width:481px)" type="text/css" />

<link rel="stylesheet" href="../_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="../_static/css/bootstrap3/bootswatch-yeti.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" href="../_static/css/adjust_theme/bootswatch-yeti.css" type="text/css" />

<link rel="stylesheet" href="../_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="../_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/ls.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/new.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/custom_pygments.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    '../',
            VERSION:     '',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="../_static/js/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Ayoub Malek&#39;s blog" href="../index.html" />
   
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Ayoub Malek&#39;s Blog</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">[01-04-2019] Authenticated encryption</a><ul>
<li><a class="reference internal" href="#what-is-an-ae">What is an AE?</a></li>
<li><a class="reference internal" href="#the-different-combinations-resulting-in-ae">The different combinations resulting in AE</a><ul>
<li><a class="reference internal" href="#ae-flaws-and-limitations">AE flaws and limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a class="uplink" href="../index.html">Contents</a></li>
            <li class="visible-xs"><a href="../_sources/blog/AuthenticatedEncryption.rst.txt" rel="nofollow">Show Source</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="../search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container">

      <!-- row -->
      <div class="row">
          
        

        <div class="col-md-12" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
                <div class="body">
                  
  <div class="section" id="authenticated-encryption">
<h1>[01-04-2019] Authenticated encryption<a class="headerlink" href="#authenticated-encryption" title="Permalink to this headline">¶</a></h1>
<p>With growing dependency on information technology and more at stake, the security aspect has become more vital than ever.
Within this context acts authenticated encryption(AE) as a shared-key based transform whose goal is to provide secrecy, Integrity and authenticity of the encapsulated data <a class="reference internal" href="references/References.html#bellare" id="id1">[MB07]</a>.
AE combines traditional Symmetric Encryption (SE) with a Message Authentication Code (MAC) in different orders <a class="reference internal" href="references/References.html#nampere" id="id2">[CNS14]</a>.
This article introduces the different combinations of authenticated encryption and their applications.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Keywords: Authenticated Encryption, Symmetric Encryption, Message Authentication Code.</p>
<div class="section" id="what-is-an-ae">
<h2>What is an AE?<a class="headerlink" href="#what-is-an-ae" title="Permalink to this headline">¶</a></h2>
<p>Nowadays, the traditional approach to secure communications is to establish a “secure channel” between two endpoints and then exchange encrypted data <a class="reference internal" href="references/References.html#hugo" id="id3">[Kra01]</a>.
Typically, this is done by initiating a secure key-exchange (or multiple keys), which will be later used to encrypt/decrypt the exchanged data.
This approach is used in many protocols such as: Secure Sockets Layer (SSL: predecessor of TLS), Internet Protocol security (IPsec), Secure Shell (SSH) etc. <a class="reference internal" href="references/References.html#hugo" id="id4">[Kra01]</a>.
An authenticated encryption is composed by two main blocks; Message Authentication Code (MAC) and a Symmetric Encryption (SE).
The MAC is a piece of information (often called a tag) generated based on the data at hand and is transmitted throughout the channel within the sent package.
The tag is then used in the receiving end to verify the data integrity and the authenticity of its source.
SE on the other hand refers to an encryption algorithms using the same cryptographic key for both encryption and decryption.
Encryption transforms a plain-text into unreadable text (Cipher-text), to ensure the privacy of the interactions.
The authenticated encryption combination of MAC and SE provides Integrity and Authenticity using the MAC and Privacy through SE.</p>
</div>
<div class="section" id="the-different-combinations-resulting-in-ae">
<h2>The different combinations resulting in AE<a class="headerlink" href="#the-different-combinations-resulting-in-ae" title="Permalink to this headline">¶</a></h2>
<p>There are various approaches to authenticated encryption that differs essentially in the way the MAC and the SE are combined.
To describe these three methods effectively, we consider P as Plain-text, C as Cipher-text, SE is a symmetric encryption function, K stands for Key, MAC is a message authentication code, T is the generated tag and || denotes concatenation.
This results in the following three different approaches:</p>
<ul class="simple">
<li><p><strong>MAC and Encrypt (M&amp;E):</strong> In this approach the sender computes a MAC of the P, encrypts the P, and then appends the MAC to the C <a class="reference internal" href="references/References.html#moxie" id="id5">[Mar18]</a>.
This is how SSH works and can be described by:
<span class="math notranslate nohighlight">\(C = E_{k1}(P) || MAC_{k2}(P)\)</span></p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li><p><strong>MAC-then-Encrypt (MtE):</strong> Here the sender computes a MAC of the P, then encrypts both the P and the MAC <a class="reference internal" href="references/References.html#moxie" id="id6">[Mar18]</a>.
This is approximately how SSL works.
<span class="math notranslate nohighlight">\(C = E_{k1}(P || MAC_{k2}(P))\)</span></p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul class="simple">
<li><p><strong>Encrypt-then-MAC (EtM):</strong> It consists of encrypting the P first and then appending a MAC of the result <a class="reference internal" href="references/References.html#moxie" id="id7">[Mar18]</a>.
This scheme is used in IPsec and can be summed by:
<span class="math notranslate nohighlight">\(C = E_{k1}(P) || MAC_{k2}(E_{k1}(P))\)</span></p></li>
</ul>
<img alt="../_images/ae.png" class="align-center" src="../_images/ae.png" />
<center><a href="../_static/figures/fig3.html" >Fig3: SE and MAC combinations</a> </center>
</div><div class="section" id="ae-flaws-and-limitations">
<h3>AE flaws and limitations<a class="headerlink" href="#ae-flaws-and-limitations" title="Permalink to this headline">¶</a></h3>
<p>Although SE and the MAC can be independently secure, their combination is not necessarily unbreakable. For example, when using MtE, one needs to remove the padding that was originally introduced during the encryption process before decrypting <a class="reference internal" href="references/References.html#moxie" id="id8">[Mar18]</a>.
This un-padding before decryption reveals a huge vulnerability since the receiver throws two distinct errors with different delays:</p>
<ul class="simple">
<li><p>Padding error if the padding is incorrect.</p></li>
<li><p>Decryption error in case of faulty decryption.</p></li>
</ul>
<p>Knowing that the receiver always checks the last byte first to process padding, an attacker can build a cipher-text to be decrypted arbitrarily by modifying the last byte of the second to last cipher-text block <a class="reference internal" href="references/References.html#moxie" id="id9">[Mar18]</a>.
When processing the message, the receiver has two possible crypto-related errors: a padding error, or a MAC error <a class="reference internal" href="references/References.html#moxie" id="id10">[Mar18]</a>.
This revelation of the error can result in the following scenario:</p>
<blockquote>
<div><p>The attacker first intercepts a cipher-text of 2 blocks using sniffing for instance. Knowing that CBC-decryption uses the previous block as an Initialization Vector (IV) for the decryption process of the current cipher-text,
the decryption process can be summarized in the following formula, where D stands for decryption, c is the 2nd block of the cipher-text and p is its associated plain-text block: <span class="math notranslate nohighlight">\(D(c) \oplus IV = p\)</span></p>
<p>With the help of this combination of MAC and CBC the attacker first sends to the receiver a packet where the L byte of the IV is altered, if a success message is received, then he changes the L-1 byte and so on until he receives an error at L-6 for example.
This use of a package to interact with the AE is called a padding oracle and would enable the attacker to determine the used padding and the length of the data.
The attacker then seeks to introduce a higher padding by changing the IV values, while changing the second byte. Once he doesn’t receive a padding error, using some basic math the value of the plain-text second byte is determined as in figure 5.
Using these steps, the attacker can determine a full plain-text block that he can later use alongside its associated cipher-text block to determine the key.
Once the key is known, the whole interaction becomes open to the attacker. This attack is called a <strong>Padding oracle attack</strong> or <strong>the Vaudenay attack</strong> <a class="reference internal" href="references/References.html#moxie" id="id11">[Mar18]</a>.</p>
</div></blockquote>
<p>At first glance this may seem avoidable by simply not revealing the type of error, whether it is a padding or MAC-error (note that some error feedback is practical to have, especially in web-services).
However, the threat is still unavoidable since the attacker can analyze the time taken to respond.
This helps the attacker to determine, whether a padding error or a MAC-error was detected (A MAC error obviously takes longer since the receiver must first remove the padding, decrypt and then verify the MAC).
This is known as a <strong>timing attack</strong>. These type of attacks are part of <strong>chosen cipher-text attacks</strong>. M&amp;E is also vulnerable to the same type of attacks, therefore Encrypt-then-MAC is the best practice of AE.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>To summarize, AE is a combination of SE and MAC that ensures integrity, authenticity and secrecy. Depending on the combination order of SE and MAC, we have 3 types of AE.
Out of those, Encrypt-then-MAC is the recommended approach to authenticated encryption. However, MAC-then-encrypt is still a safe and fast approach under certain tight conditions (the case of SSL for instance).</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="references/References.html">References</a></li>
</ul>
</div>
</div>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  Previous: 
  <a href="Encryption.html">
    
    [03.03.2019] Encryption
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  Next: 
  <a href="VoiceBasedGenderRecognition.html">
    [09-05-2019] Voice based gender recognition
    
  </a>
  </span>
  
</div>

  
  
  </div>

                </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="../index.html">Ayoub Malek&#39;s Blog</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a class="uplink" href="../index.html">Contents</a></li>
        <li><a href="#">top</a></li>
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
          &copy; Copyright 2018, SuperKogito.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.1.1.
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/><meta content="Audio signal framing/ frame blocking" name="description"/>
<meta content="framing, frame blocking, python" name="keywords"/>
<meta content="Ayoub Malek" name="author"/>
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-133660046-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
<title>Signal framing — Ayoub Malek's blog</title>
<link href="../_static/alabaster.css" rel="stylesheet" type="text/css"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom_style.css" rel="stylesheet" type="text/css"/>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/language_data.js" type="text/javascript"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<link href="../_static/favicon.ico" rel="shortcut icon"/>
<link href="../about.html" rel="author" title="About these documents"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../_static/custom.css" rel="stylesheet" type="text/css"/>
<meta content="width=device-width, initial-scale=0.9, maximum-scale=0.9" name="viewport"/>
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/></head><body>
<div class="document">
<div class="documentwrapper">
<div class="body" role="main">
<!-- START Bootstrap-Cookie-Alert -->
<div class="alert text-center cookiealert" role="alert">
<div class="cookiesContainer">
<b>
                    We use cookies and other technologies to perform analytics and deliver a better user experience.
                    By clicking “I agree” below, you consent to the use by us and our third-party partners of cookies and data gathered from your use of this website.
                    See our <a href="https://cookiesandyou.com/" target="_blank">Privacy Policy</a> and <a href="https://cookiesandyou.com/" target="_blank">Third Party Partners</a> to learn more about the use of data and your rights.
                    You also agree to our <a href="https://cookiesandyou.com/" target="_blank">Terms of Service</a>.
                </b>
<button class="btn btn-primary btn-sm acceptcookies" type="button">
                    I agree
                </button>
</div>
</div>
<!-- END Bootstrap-Cookie-Alert -->
<div class="section" id="signal-framing">
<h1>Signal framing<a class="headerlink" href="#signal-framing" title="Permalink to this headline">¶</a></h1><html><body><div class="sub-title-menu">
<table class="menu-table" id="menuTable" style="border:hidden;">
<tr>
<th>
</th><th>
</th><th class="icon"> <a href="../index.html" title="Home"><i class="fa fa-home"></i></a> </th>
<th class="menu-label"> <a href="../index.html" title="Home">Home</a> </th>
<th>
</th><th>
</th><th class="icon"><a href="../posts.html" title="Posts"><i class="fa fa-bars"></i></a></th>
<th class="menu-label"><a href="../posts.html" title="Posts">Posts</a></th>
<th>
</th><th>
</th><th class="icon"> <a href="../publications.html" title="pubs"><i class="fa fa-file-text"></i></a></th>
<th class="menu-label"> <a href="../publications.html" title="pubs">Publications</a></th>
<th>
</th><th>
</th><th class="icon"> <a href="../projects.html" title="projects"><i class="fa fa-code"></i></a></th>
<th class="menu-label"> <a href="../projects.html" title="projects">Projects</a></th>
<th>
</th><th>
</th><th class="icon"><a href="../about.html" title="About"><i class="fa fa-user-circle"></i></a></th>
<th class="menu-label"><a href="../about.html" title="About">About</a></th>
<th>
</th><th>
</th><th class="icon"> <a href="#" onclick="modeSwitcher()"><i class="fa fa-adjust"></i></a></th>
<th class="menu-label"> <a href="#" onclick="modeSwitcher()"><text id="theme-toggle">DARK MODE</text></a></th>
</tr>
</table>
</div>
</body></html>
<div class="blog-post-tags">
<ul class="blog-posts-details">
<li id="Date"><span>Date:</span>                 25 January 2020 </li>
<li id="author"><span>Author:</span> <a href="author/ayoub-malek.html">Ayoub Malek</a> </li>
<li id="location"><span>Location:</span> <a href="location/munich.html">Munich</a>
</li> <li id="language"><span>Language:</span> <a href="language/english.html">English</a>
</li> <li id="category"><span>Category:</span> <a href="category/signal-processing.html">Signal Processing</a>
</li>
<li id="tags"><span>Tags:
        </span>
<a class="post-tags" href="tag/audio.html">Audio</a>
<a class="post-tags" href="tag/framing.html">Framing</a>
<a class="post-tags" href="tag/python.html">Python</a>
</li>
</ul>
</div><hr class="docutils"/>
<p>When it comes to non-stationary signals, spectral features in short parts/ sequences are of great use.
Therefore, decomposing the signal into multiple ranges is the way to go about this type of features extraction.
This technique is known as frame blocking or framing. The following blog explains why do we need framing and how to do it in python.</p>
<div class="section" id="what-is-framing">
<h2>What is framing ?<a class="headerlink" href="#what-is-framing" title="Permalink to this headline">¶</a></h2>
<p>Frame blocking or framing is a fundamental signal processing technique that consists of dividing
the original signal into <span class="math notranslate nohighlight">\(\#F\)</span> blocks often called frames with length <span class="math notranslate nohighlight">\(N_f\)</span> an overlap <span class="math notranslate nohighlight">\(M\)</span> and a framing hop <span class="math notranslate nohighlight">\(H (H = N_f - M)\)</span>.
Overlapping the frames help avoiding information loss in between adjacent frames.</p>
<div class="line-block">
<div class="line"><br/></div>
</div>
<a class="reference internal image-reference" href="../_images/framing.png"><img alt="../_images/framing.png" class="align-center" src="../_images/framing.png" style="width: 322.15px; height: 136.0px;"/></a>
<center><a href="../figures/fig16.html">Figure 16: Framing</a> </center>
</div><p>Assuming a signal <span class="math notranslate nohighlight">\(S = \sum_{n=0}^{N_s-1} x[n]\)</span>, this can be mathematically formulated as follows:
<span class="math notranslate nohighlight">\(S = \sum_{n=0}^{N_s} X[n] = \sum_{i=0}^{\#F-1} F[i]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span>: Discrete signal.</p></li>
<li><p><span class="math notranslate nohighlight">\(x[n]\)</span>: Signal samples in time domain.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> : Signal length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(f[i]\)</span>: Signal frame.</p></li>
<li><p><span class="math notranslate nohighlight">\(\#F\)</span> : Number of frames.</p></li>
</ul>
</div>
<div class="section" id="why-do-we-do-need-framing">
<h2>Why do we do need framing?<a class="headerlink" href="#why-do-we-do-need-framing" title="Permalink to this headline">¶</a></h2>
<p>Speech is a non-stationary signal, consequently its statistical properties are not constant over time.
Therefore, its spectral features and other characteristic properties (for example: short-time energy, MFCC etc.) should be extracted from small blocks of the signal.
This is based on the assumption that is the signal is stationary (i.e.  its  statistical properties  are  constant  within this region) in this small frame <a class="bibtex reference internal" href="#deller" id="id1">[JRJD87]</a>.
On top of it all, frame blocking is often used in real-time systems as it maximizes the efficiency of the system by distributing the fixed process overhead across many samples.</p>
</div>
<div class="section" id="how-to-implement-it">
<h2>How to implement it?<a class="headerlink" href="#how-to-implement-it" title="Permalink to this headline">¶</a></h2>
<p>The first approach is pretty straight forward and can be summarized in the following steps:</p>
<ul>
<li><p><strong>Convert hop step and fame length from seconds to samples.</strong></p>
<p>To understand this, we need to comprehend the terminology and the difference between a <strong>frame</strong> &amp; a  <strong>sample</strong>.
Assume a discrete audio signal with  a duration of 3 seconds and a sampling rate of 8 KHz.
The sampling rate define the the number of samples/ signal measurements per second.
8 KHz translates to 8000 Hz = 8000 1/s = 8000 <strong>sample</strong> per second.
So in this case, the signal has 3 x 8000 = 24 000 sample.
On the other hand, a <strong>frame</strong> is a part of the signal or a series of consecutive samples.
A 1 second-long, in this case, contains 1 x 8000 = 8000 samples.
In order to convert the values of the framing hop and length from seconds to samples, we just need to multiply by sampling rate.</p>
<ul class="simple">
<li><p>frame_hop_in_samples = sampling_rate x frame_hop_in_seconds</p></li>
<li><p>frame_length_in_samples = sampling_rate x frame_length_in_seconds</p></li>
</ul>
</li>
<li><p><strong>Compute the expected number of frames.</strong></p>
<p>The expected number of frames can be compute using the following formula:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    \#F =  \left\lfloor \frac{N_s - M}{N_f - M} \right\rfloor
\end{eqnarray}</div><p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\#F\)</span> : Number of frames.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> : Signal length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> : Frame length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(M\)</span>   : Frames overlap.</p></li>
</ul>
</li>
<li><p><strong>Pad signal if needed.</strong>
Sometimes, it happens that the signal need to be padded in order to include all samples in frames with equal length.
Therefore, we also compute the number of rest samples, which equivalent to the amount of samples missing from the last frame to be equally long as the other frames.
This value will be used in the padding of the last frame, so that all frames will be equally long.</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    \#R =  \left\lfloor (N_s - M) \bmod (N_f - M) \right\rfloor
\end{eqnarray}</div><p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\#R\)</span> : Number of rest samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> : Signal length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> : Frame length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(M\)</span>   : Frames overlap.</p></li>
</ul>
<p>Consequently, the number of samples to pad the signal is equal to <span class="math notranslate nohighlight">\(N_f - \#R\)</span> and <span class="math notranslate nohighlight">\(\#F = \#F + 1\)</span></p>
</li>
<li><p><strong>Compute frames indices.</strong>
There are various ways to do this, but once you have the number frames and their lengths, it is only a matter of computing and where each frame starts and finishes.</p></li>
<li><p><strong>Get frames</strong></p></li>
</ul>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<p>The previously listed steps, can be implemented in Python as follows:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Framing 1</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


 <span class="k">def</span> <span class="nf">framing</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span> <span class="n">win_len</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">win_hop</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
     <span class="sd">"""</span>
<span class="sd">     transform a signal into a series of overlapping frames.</span>

<span class="sd">     Args:</span>
<span class="sd">         sig            (array) : a mono audio signal (Nx1) from which to compute features.</span>
<span class="sd">         fs               (int) : the sampling frequency of the signal we are working with.</span>
<span class="sd">                                  Default is 16000.</span>
<span class="sd">         win_len        (float) : window length in sec.</span>
<span class="sd">                                  Default is 0.025.</span>
<span class="sd">         win_hop        (float) : step between successive windows in sec.</span>
<span class="sd">                                  Default is 0.01.</span>

<span class="sd">     Returns:</span>
<span class="sd">         array of frames.</span>
<span class="sd">         frame length.</span>
<span class="sd">     """</span>
     <span class="c1"># compute frame length and frame step (convert from seconds to samples)</span>
     <span class="n">frame_length</span> <span class="o">=</span> <span class="n">win_len</span> <span class="o">*</span> <span class="n">fs</span>
     <span class="n">frame_step</span> <span class="o">=</span> <span class="n">win_hop</span> <span class="o">*</span> <span class="n">fs</span>
     <span class="n">signal_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
     <span class="n">frames_overlap</span> <span class="o">=</span> <span class="n">frame_length</span> <span class="o">-</span> <span class="n">frame_step</span>

     <span class="c1"># Make sure that we have at least 1 frame+</span>
     <span class="n">num_frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span> <span class="o">//</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frame_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span>
     <span class="n">rest_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frame_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span>

     <span class="c1"># Pad Signal to make sure that all frames have equal number of samples</span>
     <span class="c1"># without truncating any samples from the original signal</span>
     <span class="k">if</span> <span class="n">rest_samples</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
         <span class="n">pad_signal_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span> <span class="o">-</span> <span class="n">rest_samples</span><span class="p">)</span>
         <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">pad_signal_length</span><span class="p">))</span>
         <span class="n">pad_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
         <span class="n">num_frames</span> <span class="o">+=</span> <span class="mi">1</span>
     <span class="k">else</span><span class="p">:</span>
         <span class="n">pad_signal</span> <span class="o">=</span> <span class="n">sig</span>

     <span class="c1"># make sure to use integers as indices</span>
     <span class="n">frame_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_length</span><span class="p">)</span>
     <span class="n">frame_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span><span class="p">)</span>
     <span class="n">num_frames</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_frames</span><span class="p">)</span>

     <span class="c1"># compute indices</span>
     <span class="n">idx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame_length</span><span class="p">),</span> <span class="p">(</span><span class="n">num_frames</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
     <span class="n">idx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_frames</span> <span class="o">*</span> <span class="n">frame_step</span><span class="p">,</span> <span class="n">frame_step</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">frame_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
     <span class="n">indices</span> <span class="o">=</span> <span class="n">idx1</span> <span class="o">+</span> <span class="n">idx2</span>
     <span class="n">frames</span> <span class="o">=</span> <span class="n">pad_signal</span><span class="p">[</span><span class="n">indices</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
     <span class="k">return</span> <span class="n">frames</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="line-block">
<div class="line"><br/></div>
</div>
<p>Alternatively, one can use the stride trick and use a sliding window technique that is
already implemented in matlab to get a much faster framing. This is done like the following.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Framing 2</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>



 <span class="k">def</span> <span class="nf">stride_trick</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">stride_length</span><span class="p">,</span> <span class="n">stride_step</span><span class="p">):</span>
     <span class="sd">"""</span>
<span class="sd">     apply framing using the stride trick from numpy.</span>

<span class="sd">     Args:</span>
<span class="sd">         a (array) : signal array.</span>
<span class="sd">         stride_length (int) : length of the stride.</span>
<span class="sd">         stride_step (int) : stride step.</span>

<span class="sd">     Returns:</span>
<span class="sd">         blocked/framed array.</span>
<span class="sd">     """</span>
     <span class="n">nrows</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">stride_length</span><span class="p">)</span> <span class="o">//</span> <span class="n">stride_step</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
     <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">stride_tricks</span><span class="o">.</span><span class="n">as_strided</span><span class="p">(</span><span class="n">a</span><span class="p">,</span>
                                            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">stride_length</span><span class="p">),</span>
                                            <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="n">stride_step</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>


 <span class="k">def</span> <span class="nf">framing</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span> <span class="n">win_len</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">win_hop</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
     <span class="sd">"""</span>
<span class="sd">     transform a signal into a series of overlapping frames (=Frame blocking).</span>

<span class="sd">     Args:</span>
<span class="sd">         sig     (array) : a mono audio signal (Nx1) from which to compute features.</span>
<span class="sd">         fs        (int) : the sampling frequency of the signal we are working with.</span>
<span class="sd">                           Default is 16000.</span>
<span class="sd">         win_len (float) : window length in sec.</span>
<span class="sd">                           Default is 0.025.</span>
<span class="sd">         win_hop (float) : step between successive windows in sec.</span>
<span class="sd">                           Default is 0.01.</span>

<span class="sd">     Returns:</span>
<span class="sd">         array of frames.</span>
<span class="sd">         frame length.</span>

<span class="sd">     Notes:</span>
<span class="sd">     ------</span>
<span class="sd">         Uses the stride trick to accelerate the processing.</span>
<span class="sd">     """</span>
     <span class="c1"># run checks and assertions</span>
     <span class="k">if</span> <span class="n">win_len</span> <span class="o">&lt;</span> <span class="n">win_hop</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">"ParameterError: win_len must be larger than win_hop."</span><span class="p">)</span>

     <span class="c1"># compute frame length and frame step (convert from seconds to samples)</span>
     <span class="n">frame_length</span> <span class="o">=</span> <span class="n">win_len</span> <span class="o">*</span> <span class="n">fs</span>
     <span class="n">frame_step</span> <span class="o">=</span> <span class="n">win_hop</span> <span class="o">*</span> <span class="n">fs</span>
     <span class="n">signal_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
     <span class="n">frames_overlap</span> <span class="o">=</span> <span class="n">frame_length</span> <span class="o">-</span> <span class="n">frame_step</span>

     <span class="c1"># compute number of frames and left sample in order to pad if needed to make</span>
     <span class="c1"># sure all frames have equal number of samples  without truncating any samples</span>
     <span class="c1"># from the original signal</span>
     <span class="n">rest_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frame_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span>
     <span class="n">pad_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span> <span class="o">-</span> <span class="n">rest_samples</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">rest_samples</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">)))</span>

     <span class="c1"># apply stride trick</span>
     <span class="n">frames</span> <span class="o">=</span> <span class="n">stride_trick</span><span class="p">(</span><span class="n">pad_signal</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_length</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span><span class="p">))</span>
     <span class="k">return</span> <span class="n">frames</span><span class="p">,</span> <span class="n">frame_length</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This blog presented framing, which is a fundamental signal processing technique to that divides a signal into multiple, equally sized, blocks.
The resulting blocks are considered stationary over time, which helps extract useful characterizing features of the signal.
This operation can be implemented in python in a classical fashion or using the stride trick for a fast processing.</p>
</div>
<div class="section" id="references-and-further-readings">
<h2>References and Further readings<a class="headerlink" href="#references-and-further-readings" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-blog/SignalFraming-0"></p><dl class="citation">
<dt class="bibtex label" id="deller"><span class="brackets"><a class="fn-backref" href="#id1">JRJD87</a></span></dt>
<dd><p>J. H. L. HANSEN J. R. JR Deller, J. G. PROAKIS. <em>Discrete-Time Processing of Speech Signals</em>. New Jersey: Prentice-Hall, 1987.</p>
</dd>
</dl>
<div class="share-btn" data-desc="..." data-title="..." data-url="https://...">
<!-- facebook -->
<a class="facebook" href="https://www.facebook.com/share.php?u={{url}}&amp;title={{title}}" target="blank"><i class="fa fa-facebook" style="left: 32%;"></i></a>
<!-- twitter -->
<a class="twitter" href="https://twitter.com/intent/tweet?status={{title}}+{{url}}" target="blank"><i class="fa fa-twitter" style="left: 30%;"></i></a>
<!-- google plus -->
<a class="googleplus" href="https://plus.google.com/share?url={{url}}" target="blank"><i class="fa fa-google-plus" style="left: 24%;"></i></a>
<!-- linkedin -->
<a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url={{url}}&amp;title={{title}}&amp;source={{source}}" target="blank"><i class="fa fa-linkedin" style="left: 29%;"></i></a>
<!-- pinterest -->
<a class="pinterest" href="https://pinterest.com/pin/create/bookmarklet/?media={{media}}&amp;url={{url}}&amp;is_video=false&amp;description={{title}}" target="blank"><i class="fa fa-pinterest-p" style="left: 32%;"></i></a>
</div><hr class="docutils"/>
</div>
</div>
<div class="section">
<div class="section">
<span style="float: left">
     Previous:
    
    <a href="diabetesML2.html">
       Diabetes detection using machine learning (part II)
    </a>
</span>
<span> </span>
<span style="float: right">
     Next: 
    <a href="NaiveVad.html">
      Naive voice activity detection using short time energy 
    </a>
</span>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
<div class="footer">
      ©2019-2021, Ayoub Malek.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      | <a href="https://github.com/bitprophet/alabaster">Terms of Service</a>
      | <a href="https://github.com/bitprophet/alabaster">Privacy Policy</a>
      | <a href="https://github.com/bitprophet/alabaster">Impressum</a>
</div><html><head><script async="" defer="" src="https://buttons.github.io/buttons.js"></script></head></html><html><head><script src="../_static/js/mode-switcher.js"></script></head></html>
<!-- Include cookiealert script -->
<script src="https://cdn.jsdelivr.net/gh/Wruczek/Bootstrap-Cookie-Alert@gh-pages/cookiealert.js"></script>
<script src="_static/js/share-buttons.js"></script>
</body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Audio signal windowing and spectral leakage" name="description" />
<meta content="windowing, spectral leakage, python" name="keywords" />
<meta content="Ayoub Malek" name="author" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-133660046-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Spectral leakage and windowing &#8212; Ayoub Malek&#39;s blog</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_style.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
  
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          

          <div class="body" role="main">
            <!-- START Bootstrap-Cookie-Alert -->
            <div class="alert text-center cookiealert" role="alert">
                <div class="cookiesContainer">
                  <b>
                    We use cookies and other technologies to perform analytics and deliver a better user experience.
                    By clicking “I agree” below, you consent to the use by us and our third-party partners of cookies and data gathered from your use of this website.
                    See our <a href="https://cookiesandyou.com/" target="_blank">Privacy Policy</a> and <a href="https://cookiesandyou.com/" target="_blank">Third Party Partners</a> to learn more about the use of data and your rights.
                    You also agree to our <a href="https://cookiesandyou.com/" target="_blank">Terms of Service</a>.
                </b>
                <button type="button" class="btn btn-primary btn-sm acceptcookies">
                    I agree
                </button>
              </div>
            </div>
            <!-- END Bootstrap-Cookie-Alert -->

             <section id="spectral-leakage-and-windowing">
<h1>Spectral leakage and windowing<a class="headerlink" href="#spectral-leakage-and-windowing" title="Permalink to this headline">¶</a></h1>
<div class="blog-post-tags">
  <ul class="blog-posts-details">
  <li id="Date"><span>Date:</span>                13 Mars 2020 </li>
  <li id="author"><span>Author:</span>            <a href="author/ayoub-malek.html">Ayoub Malek</a> </li>
  <li id="location"><span>Location:</span>        <a href="location/munich.html">Munich</a>
  </li>  <li id="language"><span>Language:</span> <a href="language/english.html">English</a>
  </li>  <li id="category"><span>Category:</span> <a href="category/signal-processing.html">Signal Processing</a>
  </li>
  <li id="tags"><span>Tags:
        </span>
        <a class="post-tags" href="tag/audio.html">Audio</a>
        <a class="post-tags" href="tag/python.html">Python</a>
  </li>
  </ul>
</div><hr class="docutils" />
<p>Windowing is an important part of almost any signal processing system, that helps remove/ reduce spectral leakage when processing a non-periodic signal.
This blog post provides a small overview of what is spectral usage, when does it occur and how to use windowing to suppress it.</p>
<div class="line-block">
<div class="line"><strong>* keywords:  *</strong> Windowing, Spectral leakage</div>
</div>
<section id="what-is-spectral-leakage">
<h2>What is spectral leakage ?<a class="headerlink" href="#what-is-spectral-leakage" title="Permalink to this headline">¶</a></h2>
<p>As <em>Allen B. Downey</em> mentions in his book <em>Think DSP</em>, in order to understand windowing, we must first understand spectral leakage and for that we have first to understand the Discrete Fourier Transform (DFT) and its related assumptions.
When using DFT to compute spectograms, we assume signals to be periodic. In practice, this assumption is often not fulfilled, resulting in inaccurate transform computations containing extra residual frequency components <a class="bibtex reference internal" href="#downey2014" id="id1">[DowneyAB14]</a>.
This phenomenon is known as spectral leakage, which is a smearing of power across a frequency spectrum that occurs when the processed signal is not periodic in the sample interval.
It occurs because of the discrete sampling in the effective Fourier series computations of a waveform having discontinuities results in additional frequency components <a class="bibtex reference internal" href="#roberts" id="id2">[Rob]</a>.
Leakage is a common error encountered in digital signal processing, that cannot be entirely eliminated but may be reduced using windowing.</p>
</section>
<section id="what-is-windowing">
<h2>What is windowing ?<a class="headerlink" href="#what-is-windowing" title="Permalink to this headline">¶</a></h2>
<p>Windowing is a counter-measure against spectral leakage that reduces the amplitudes of the samples at the start and end of a signal window <a class="bibtex reference internal" href="#lyon2009" id="id3">[Lyo09]</a>.
This eliminates the discontinuities, helps with the periodicity of the signal and consequently reduces any leakage <a class="bibtex reference internal" href="#downey2014" id="id4">[DowneyAB14]</a>.
Therefore, windowing is none other than a multiplication of the input signal with a predefined function.</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    S = \sum_{i=0}^{\#F-1} F[i] . w
\end{eqnarray}</div><p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span>   : Signal array.</p></li>
<li><p><span class="math notranslate nohighlight">\(\#F\)</span> : Number of frames.</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span>   : window function.</p></li>
</ul>
</section>
<section id="how-to-implement-it">
<h2>How to implement it?<a class="headerlink" href="#how-to-implement-it" title="Permalink to this headline">¶</a></h2>
<p>This is depending on the type of the windowing function to use as there are many.
However, since it is just a multiplication, the window samples are simply generated using a predefined function and multiplied with the signal samples.
In python this can be done easily using <a class="reference external" href="https://numpy.org/">numpy</a> which offers a wide variety of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.window.html">windowing_function</a></p>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<p>Here is a small code snippet implementing windowing that I wrote as part of a python audio features extraction library named <a class="reference external" href="https://github.com/SuperKogito/spafe">spafe</a></p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Windowing</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span> <span class="k">def</span> <span class="nf">windowing</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">frame_len</span><span class="p">,</span> <span class="n">win_type</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
<span class="linenos"> 5</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span><span class="sd">     generate and apply a window function to avoid spectral leakage.</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="sd">     Args:</span>
<span class="linenos"> 9</span><span class="sd">       frames  (array) : array including the overlapping frames.</span>
<span class="linenos">10</span><span class="sd">       frame_len (int) : frame length.</span>
<span class="linenos">11</span><span class="sd">       win_type  (str) : type of window to use.</span>
<span class="linenos">12</span><span class="sd">                         Default is &quot;hamming&quot;</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="sd">     Returns:</span>
<span class="linenos">15</span><span class="sd">       windowed frames.</span>
<span class="linenos">16</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos">17</span>     <span class="k">if</span>   <span class="n">win_type</span> <span class="o">==</span> <span class="s2">&quot;hamming&quot;</span> <span class="p">:</span> <span class="n">windows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">frame_len</span><span class="p">)</span>
<span class="linenos">18</span>     <span class="k">elif</span> <span class="n">win_type</span> <span class="o">==</span> <span class="s2">&quot;hanning&quot;</span> <span class="p">:</span> <span class="n">windows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">frame_len</span><span class="p">)</span>
<span class="linenos">19</span>     <span class="k">elif</span> <span class="n">win_type</span> <span class="o">==</span> <span class="s2">&quot;bartlet&quot;</span> <span class="p">:</span> <span class="n">windows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bartlett</span><span class="p">(</span><span class="n">frame_len</span><span class="p">)</span>
<span class="linenos">20</span>     <span class="k">elif</span> <span class="n">win_type</span> <span class="o">==</span> <span class="s2">&quot;kaiser&quot;</span>  <span class="p">:</span> <span class="n">windows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">frame_len</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="linenos">21</span>     <span class="k">elif</span> <span class="n">win_type</span> <span class="o">==</span> <span class="s2">&quot;blackman&quot;</span><span class="p">:</span> <span class="n">windows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">frame_len</span><span class="p">)</span>
<span class="linenos">22</span>     <span class="n">windowed_frames</span> <span class="o">=</span> <span class="n">frames</span> <span class="o">*</span> <span class="n">windows</span>
<span class="linenos">23</span>     <span class="k">return</span> <span class="n">windowed_frames</span>
</pre></div>
</div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This blog presented windowing, which is a fundamental signal processing technique that helps eliminate discontinuities in a the frames and consequently avoid spectral leakage.
This method is often used before any spectrum computations. There are various types of windowing, each having its own pros and cons.
In the python code introduced in this post, we included some of the most used functions but these can be customized to the user’s discretion.</p>
</section>
<section id="references-and-further-readings">
<h2>References and Further readings<a class="headerlink" href="#references-and-further-readings" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-blog/SpectralLeakageWindowing-0"><dl class="bibtex citation">
<dt class="bibtex label" id="lyon2009"><span class="brackets"><a class="fn-backref" href="#id3">Lyo09</a></span></dt>
<dd><p>Douglas Lyon. The Discrete Fourier Transform, Part 4: Spectral Leakage. <em>Journal of object technology</em>, 2009.</p>
</dd>
<dt class="bibtex label" id="roberts"><span class="brackets"><a class="fn-backref" href="#id2">Rob</a></span></dt>
<dd><p>S. Roberts. Leakage, 7.2.2 in Lecture 7-The Discrete Fourier Transform. [Online; accessed 13.03.2020]. URL: <a class="reference external" href="http://www.robots.ox.ac.uk/~sjrob/Teaching/SP/l7.pdf">http://www.robots.ox.ac.uk/~sjrob/Teaching/SP/l7.pdf</a>.</p>
</dd>
<dt class="bibtex label" id="downey2014"><span class="brackets">DowneyAB14</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p>Downey, A. B. <em>Think DSP</em>. Green Tea Press, 2014.</p>
</dd>
</dl>
</p>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
     Previous:
    
    <a href="NaiveVad.html">
       Naive voice activity detection using short time energy
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
     Next: 
    <a href="ffmpegpipe.html">
      How to pipe an FFmpeg output and pass it to a Python variable? 
    </a>
    
  </span>
</div>
  
</div>

          </div>
          
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019-2022, Ayoub Malek.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      | <a href="https://github.com/bitprophet/alabaster">Terms of Service</a>
      | <a href="https://github.com/bitprophet/alabaster">Privacy Policy</a>
      | <a href="https://github.com/bitprophet/alabaster">Impressum</a>

      
    </div>

    

    
    <!-- Include cookiealert script -->
    <script src="https://cdn.jsdelivr.net/gh/Wruczek/Bootstrap-Cookie-Alert@gh-pages/cookiealert.js"></script>
    <script src="_static/js/share-buttons.js"></script>
  </body>
</html>
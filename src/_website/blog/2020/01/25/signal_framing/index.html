
<!DOCTYPE html>

<html lang="english">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="Signal framing" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://superkogito.github.io/blog/2020/01/25/signal_framing/" />
<meta property="og:site_name" content="üß† SuperKogito" />
<meta property="og:description" content="Audio signal framing/ frame blocking" />
<meta property="og:image" content="http://superkogito.github.io/_static/meta_images/cryptography_overview.png" />
<meta property="og:image:alt" content="cryptography_overview" />
<meta property="og:keywords" content="framing, frame blocking, python, ayoub malek, blog introduction" />
<meta name="description" content="When it comes to non-stationary signals, spectral features in short parts/ sequences are of great use. Therefore, decomposing the signal into multiple ranges is the way to go about this type of features extraction. This technique is known as frame blocking or framing. The following blog explains ..." />
<meta property="og:ignore_canonical" content="true" />

    <title>Signal framing &#8212; üß† SuperKogito  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/twemoji.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/tree_graph.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/social_media_sharing.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../_static/copybutton.js"></script>
    <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js"></script>
    <script src="../../../../../_static/twemoji.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'blog/2020/01/25/signal_framing';</script>
    <link rel="canonical" href="http://superkogito.github.io/blog/2020/01/25/signal_framing.html" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../../../about/" />
    <link rel="index" title="Index" href="../../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../../search/" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="english"> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../../../blog/atom.xml"
  title="SuperKogito"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../../../../search/" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../../../">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">üß† SuperKogito  documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../projects/">
                        Projects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../">
                        Blog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../about/">
                        About Me
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        
<form class="bd-search d-flex align-items-center" action="../../../../../search/" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/superkogito/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../projects/">
                        Projects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../">
                        Blog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../about/">
                        About Me
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        
<form class="bd-search d-flex align-items-center" action="../../../../../search/" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/superkogito/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">  
<h2>
   <i class="fa fa-calendar"></i>
  25 January 2020 
</h2>

<ul>
  
<li id="published">
  <span><i class="fa fa-pencil-square-o"></i></span
  >
  08 April 2022
</li>
 
<li id="author">
  <span><i class="fa-fw fa fa-user"></i></span
  >
   
  <a href="../../../../author/ayoub-malek/">Ayoub Malek</a>  
</li>
 
<li id="location">
  <span><i class="fa-fw fa fa-location-arrow"></i></span
  >
   
  <a href="../../../../location/munich/">Munich</a>  
</li>
 
<li id="language">
  <span><i class="fa-fw fa fa-language"></i></span
  >
   
  <a href="../../../../language/english/">English</a>  
</li>
 
<li id="category">
  <span><i class="fa-fw fa fa-folder-open"></i></span
  >
   
  <a href="../../../../category/signal-processing/">Signal processing</a>  
</li>
 
<li id="tags">
  <span><i class="fa-fw fa fa-tags"></i> </span
  >
   
  <a href="../../../../tag/python/">Python</a>   
  <a href="../../../../tag/framing/">Framing</a>   
  <a href="../../../../tag/audio/">Audio</a>  
</li>
 
</ul>

    </div>
    <div class="sidebar-start-items__item">
<h3>
  <a href="../../../../">‚úçÔ∏è Recent Posts</a>
</h3>
<ul>
   
  <li>
    <a href="../../../../2022/12/27/whisper_aiohttp_server_with_token/"
      >Token authenticated Whisper based speech recognition aiohttp server</a>
      <p>27 December 2022</p>
  </li>
  
  <li>
    <a href="../../../../2021/12/31/aiohttp_server_with_token/"
      >Token authenticated aiohttp server</a>
      <p>31 December 2021</p>
  </li>
  
  <li>
    <a href="../../../../2021/12/31/aiohttp_server/"
      >Basic aiohttp server</a>
      <p>31 December 2021</p>
  </li>
  
  <li>
    <a href="../../../10/25/chmod_modes/"
      >Chmod modes: from symbolic to octal and back</a>
      <p>25 October 2020</p>
  </li>
  
  <li>
    <a href="../../../10/03/divide_image_using_gdiplus/"
      >Divide an image into blocks using GDI+ in C++</a>
      <p>03 October 2020</p>
  </li>
  
</ul>

    </div>
    <div class="sidebar-start-items__item">
<h3>
  <a href="../../../../archive/">üóìÔ∏è Archives</a>
</h3>
<ul>
   
  <li>
    <a href="../../../../2022/">2022 (1)</a>
  </li>
    
  <li>
    <a href="../../../../2021/">2021 (2)</a>
  </li>
    
  <li>
    <a href="../../../">2020 (13)</a>
  </li>
    
  <li>
    <a href="../../../../2019/">2019 (7)</a>
  </li>
   
</ul>

    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            


<!--  Bootstrap HTML  -->
<div id="lawmsg" class="alert alert-info alert-dismissible h5 fade show fixed-bottom" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    We use cookies on this website to distinguish you from other users.
    We use this data to improve our content experience and for targeted advertising.
    By continuing to use this website you consent to our use of cookies.
    For more information, please see our
    <a href="https://superkogito.github.io/policy/cookies_policy.html" target="_blank">Cookie Policy</a>.
</div>



            <article class="bd-article" role="main">
               <section id="signal-framing">
<h1>Signal framing<a class="headerlink" href="#signal-framing" title="Permalink to this headline">#</a></h1>
<hr class="docutils" />
<p>When it comes to non-stationary signals, spectral features in short parts/ sequences are of great use.
Therefore, decomposing the signal into multiple ranges is the way to go about this type of features extraction.
This technique is known as frame blocking or framing. The following blog explains why do we need framing and how to do it in python.</p>
<section id="what-is-framing">
<h2>What is framing ?<a class="headerlink" href="#what-is-framing" title="Permalink to this headline">#</a></h2>
<p>Frame blocking or framing is a fundamental signal processing technique that consists of dividing
the original signal into <span class="math notranslate nohighlight">\(\#F\)</span> blocks often called frames with length <span class="math notranslate nohighlight">\(N_f\)</span> an overlap <span class="math notranslate nohighlight">\(M\)</span> and a framing hop <span class="math notranslate nohighlight">\(H (H = N_f - M)\)</span>.
Overlapping the frames help avoiding information loss in between adjacent frames.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../../../../_images/framing.png"><img alt="../../../../../_images/framing.png" src="../../../../../_images/framing.png" style="width: 322.15px; height: 136.0px;" /></a>
<figcaption>
<p><span class="caption-text">Figure 16: Framing</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Assuming a signal <span class="math notranslate nohighlight">\(S = \sum_{n=0}^{N_s-1} x[n]\)</span>, this can be mathematically formulated as follows:
<span class="math notranslate nohighlight">\(S = \sum_{n=0}^{N_s} X[n] = \sum_{i=0}^{\#F-1} F[i]\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span>: Discrete signal.</p></li>
<li><p><span class="math notranslate nohighlight">\(x[n]\)</span>: Signal samples in time domain.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> : Signal length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(f[i]\)</span>: Signal frame.</p></li>
<li><p><span class="math notranslate nohighlight">\(\#F\)</span> : Number of frames.</p></li>
</ul>
</section>
<section id="why-do-we-do-need-framing">
<h2>Why do we do need framing?<a class="headerlink" href="#why-do-we-do-need-framing" title="Permalink to this headline">#</a></h2>
<p>Speech is a non-stationary signal, consequently its statistical properties are not constant over time.
Therefore, its spectral features and other characteristic properties (for example: short-time energy, MFCC etc.) should be extracted from small blocks of the signal.
This is based on the assumption that is the signal is stationary (i.e.  its  statistical properties  are  constant  within this region) in this small frame <a class="footnote-reference brackets" href="#footcite-deller" id="id1">1</a>.
On top of it all, frame blocking is often used in real-time systems as it maximizes the efficiency of the system by distributing the fixed process overhead across many samples.</p>
</section>
<section id="how-to-implement-it">
<h2>How to implement it?<a class="headerlink" href="#how-to-implement-it" title="Permalink to this headline">#</a></h2>
<p>The first approach is pretty straight forward and can be summarized in the following steps:</p>
<ul>
<li><p><strong>Convert hop step and fame length from seconds to samples.</strong></p>
<p>To understand this, we need to comprehend the terminology and the difference between a <strong>frame</strong> &amp; a  <strong>sample</strong>.
Assume a discrete audio signal with  a duration of 3 seconds and a sampling rate of 8 KHz.
The sampling rate define the the number of samples/ signal measurements per second.
8 KHz translates to 8000 Hz = 8000 1/s = 8000 <strong>sample</strong> per second.
So in this case, the signal has 3 x 8000 = 24 000 sample.
On the other hand, a <strong>frame</strong> is a part of the signal or a series of consecutive samples.
A 1 second-long, in this case, contains 1 x 8000 = 8000 samples.
In order to convert the values of the framing hop and length from seconds to samples, we just need to multiply by sampling rate.</p>
<ul class="simple">
<li><p>frame_hop_in_samples = sampling_rate x frame_hop_in_seconds</p></li>
<li><p>frame_length_in_samples = sampling_rate x frame_length_in_seconds</p></li>
</ul>
</li>
<li><p><strong>Compute the expected number of frames.</strong></p>
<p>The expected number of frames can be compute using the following formula:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    \#F =  \left\lfloor \frac{N_s - M}{N_f - M} \right\rfloor
\end{eqnarray}</div><p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\#F\)</span> : Number of frames.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> : Signal length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> : Frame length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(M\)</span>   : Frames overlap.</p></li>
</ul>
</li>
<li><p><strong>Pad signal if needed.</strong>
Sometimes, it happens that the signal need to be padded in order to include all samples in frames with equal length.
Therefore, we also compute the number of rest samples, which equivalent to the amount of samples missing from the last frame to be equally long as the other frames.
This value will be used in the padding of the last frame, so that all frames will be equally long.</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
    \#R =  \left\lfloor (N_s - M) \bmod (N_f - M) \right\rfloor
\end{eqnarray}</div><p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\#R\)</span> : Number of rest samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_s\)</span> : Signal length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span> : Frame length in samples.</p></li>
<li><p><span class="math notranslate nohighlight">\(M\)</span>   : Frames overlap.</p></li>
</ul>
<p>Consequently, the number of samples to pad the signal is equal to <span class="math notranslate nohighlight">\(N_f - \#R\)</span> and <span class="math notranslate nohighlight">\(\#F = \#F + 1\)</span></p>
</li>
<li><p><strong>Compute frames indices.</strong>
There are various ways to do this, but once you have the number frames and their lengths, it is only a matter of computing and where each frame starts and finishes.</p></li>
<li><p><strong>Get frames</strong></p></li>
</ul>
<section id="code">
<h3>Code<a class="headerlink" href="#code" title="Permalink to this headline">#</a></h3>
<p>The previously listed steps, can be implemented in Python as follows:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Framing 1</span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span> <span class="k">def</span> <span class="nf">framing</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span> <span class="n">win_len</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">win_hop</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="linenos"> 5</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span><span class="sd">     transform a signal into a series of overlapping frames.</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="sd">     Args:</span>
<span class="linenos"> 9</span><span class="sd">         sig            (array) : a mono audio signal (Nx1) from which to compute features.</span>
<span class="linenos">10</span><span class="sd">         fs               (int) : the sampling frequency of the signal we are working with.</span>
<span class="linenos">11</span><span class="sd">                                  Default is 16000.</span>
<span class="linenos">12</span><span class="sd">         win_len        (float) : window length in sec.</span>
<span class="linenos">13</span><span class="sd">                                  Default is 0.025.</span>
<span class="linenos">14</span><span class="sd">         win_hop        (float) : step between successive windows in sec.</span>
<span class="linenos">15</span><span class="sd">                                  Default is 0.01.</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="sd">     Returns:</span>
<span class="linenos">18</span><span class="sd">         array of frames.</span>
<span class="linenos">19</span><span class="sd">         frame length.</span>
<span class="linenos">20</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos">21</span>     <span class="c1"># compute frame length and frame step (convert from seconds to samples)</span>
<span class="linenos">22</span>     <span class="n">frame_length</span> <span class="o">=</span> <span class="n">win_len</span> <span class="o">*</span> <span class="n">fs</span>
<span class="linenos">23</span>     <span class="n">frame_step</span> <span class="o">=</span> <span class="n">win_hop</span> <span class="o">*</span> <span class="n">fs</span>
<span class="linenos">24</span>     <span class="n">signal_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<span class="linenos">25</span>     <span class="n">frames_overlap</span> <span class="o">=</span> <span class="n">frame_length</span> <span class="o">-</span> <span class="n">frame_step</span>
<span class="linenos">26</span>
<span class="linenos">27</span>     <span class="c1"># Make sure that we have at least 1 frame+</span>
<span class="linenos">28</span>     <span class="n">num_frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span> <span class="o">//</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frame_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span>
<span class="linenos">29</span>     <span class="n">rest_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frame_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span>
<span class="linenos">30</span>
<span class="linenos">31</span>     <span class="c1"># Pad Signal to make sure that all frames have equal number of samples</span>
<span class="linenos">32</span>     <span class="c1"># without truncating any samples from the original signal</span>
<span class="linenos">33</span>     <span class="k">if</span> <span class="n">rest_samples</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">34</span>         <span class="n">pad_signal_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span> <span class="o">-</span> <span class="n">rest_samples</span><span class="p">)</span>
<span class="linenos">35</span>         <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">pad_signal_length</span><span class="p">))</span>
<span class="linenos">36</span>         <span class="n">pad_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="linenos">37</span>         <span class="n">num_frames</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">38</span>     <span class="k">else</span><span class="p">:</span>
<span class="linenos">39</span>         <span class="n">pad_signal</span> <span class="o">=</span> <span class="n">sig</span>
<span class="linenos">40</span>
<span class="linenos">41</span>     <span class="c1"># make sure to use integers as indices</span>
<span class="linenos">42</span>     <span class="n">frame_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_length</span><span class="p">)</span>
<span class="linenos">43</span>     <span class="n">frame_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span><span class="p">)</span>
<span class="linenos">44</span>     <span class="n">num_frames</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_frames</span><span class="p">)</span>
<span class="linenos">45</span>
<span class="linenos">46</span>     <span class="c1"># compute indices</span>
<span class="linenos">47</span>     <span class="n">idx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame_length</span><span class="p">),</span> <span class="p">(</span><span class="n">num_frames</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="linenos">48</span>     <span class="n">idx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_frames</span> <span class="o">*</span> <span class="n">frame_step</span><span class="p">,</span> <span class="n">frame_step</span><span class="p">),</span>
<span class="linenos">49</span>                    <span class="p">(</span><span class="n">frame_length</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="linenos">50</span>     <span class="n">indices</span> <span class="o">=</span> <span class="n">idx1</span> <span class="o">+</span> <span class="n">idx2</span>
<span class="linenos">51</span>     <span class="n">frames</span> <span class="o">=</span> <span class="n">pad_signal</span><span class="p">[</span><span class="n">indices</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
<span class="linenos">52</span>     <span class="k">return</span> <span class="n">frames</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Alternatively, one can use the stride trick and use a sliding window technique that is
already implemented in matlab to get a much faster framing. This is done like the following.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Framing 2</span><a class="headerlink" href="#id5" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span> <span class="k">def</span> <span class="nf">stride_trick</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">stride_length</span><span class="p">,</span> <span class="n">stride_step</span><span class="p">):</span>
<span class="linenos"> 6</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 7</span><span class="sd">     apply framing using the stride trick from numpy.</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="sd">     Args:</span>
<span class="linenos">10</span><span class="sd">         a (array) : signal array.</span>
<span class="linenos">11</span><span class="sd">         stride_length (int) : length of the stride.</span>
<span class="linenos">12</span><span class="sd">         stride_step (int) : stride step.</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="sd">     Returns:</span>
<span class="linenos">15</span><span class="sd">         blocked/framed array.</span>
<span class="linenos">16</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos">17</span>     <span class="n">nrows</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">stride_length</span><span class="p">)</span> <span class="o">//</span> <span class="n">stride_step</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="linenos">18</span>     <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">19</span>     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">stride_tricks</span><span class="o">.</span><span class="n">as_strided</span><span class="p">(</span><span class="n">a</span><span class="p">,</span>
<span class="linenos">20</span>                                            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">stride_length</span><span class="p">),</span>
<span class="linenos">21</span>                                            <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="n">stride_step</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="linenos">22</span>
<span class="linenos">23</span>
<span class="linenos">24</span> <span class="k">def</span> <span class="nf">framing</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span> <span class="n">win_len</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">win_hop</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="linenos">25</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">26</span><span class="sd">     transform a signal into a series of overlapping frames (=Frame blocking).</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="sd">     Args:</span>
<span class="linenos">29</span><span class="sd">         sig     (array) : a mono audio signal (Nx1) from which to compute features.</span>
<span class="linenos">30</span><span class="sd">         fs        (int) : the sampling frequency of the signal we are working with.</span>
<span class="linenos">31</span><span class="sd">                           Default is 16000.</span>
<span class="linenos">32</span><span class="sd">         win_len (float) : window length in sec.</span>
<span class="linenos">33</span><span class="sd">                           Default is 0.025.</span>
<span class="linenos">34</span><span class="sd">         win_hop (float) : step between successive windows in sec.</span>
<span class="linenos">35</span><span class="sd">                           Default is 0.01.</span>
<span class="linenos">36</span>
<span class="linenos">37</span><span class="sd">     Returns:</span>
<span class="linenos">38</span><span class="sd">         array of frames.</span>
<span class="linenos">39</span><span class="sd">         frame length.</span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="sd">     Notes:</span>
<span class="linenos">42</span><span class="sd">     ------</span>
<span class="linenos">43</span><span class="sd">         Uses the stride trick to accelerate the processing.</span>
<span class="linenos">44</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos">45</span>     <span class="c1"># run checks and assertions</span>
<span class="linenos">46</span>     <span class="k">if</span> <span class="n">win_len</span> <span class="o">&lt;</span> <span class="n">win_hop</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ParameterError: win_len must be larger than win_hop.&quot;</span><span class="p">)</span>
<span class="linenos">47</span>
<span class="linenos">48</span>     <span class="c1"># compute frame length and frame step (convert from seconds to samples)</span>
<span class="linenos">49</span>     <span class="n">frame_length</span> <span class="o">=</span> <span class="n">win_len</span> <span class="o">*</span> <span class="n">fs</span>
<span class="linenos">50</span>     <span class="n">frame_step</span> <span class="o">=</span> <span class="n">win_hop</span> <span class="o">*</span> <span class="n">fs</span>
<span class="linenos">51</span>     <span class="n">signal_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
<span class="linenos">52</span>     <span class="n">frames_overlap</span> <span class="o">=</span> <span class="n">frame_length</span> <span class="o">-</span> <span class="n">frame_step</span>
<span class="linenos">53</span>
<span class="linenos">54</span>     <span class="c1"># compute number of frames and left sample in order to pad if needed to make</span>
<span class="linenos">55</span>     <span class="c1"># sure all frames have equal number of samples  without truncating any samples</span>
<span class="linenos">56</span>     <span class="c1"># from the original signal</span>
<span class="linenos">57</span>     <span class="n">rest_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frame_length</span> <span class="o">-</span> <span class="n">frames_overlap</span><span class="p">)</span>
<span class="linenos">58</span>     <span class="n">pad_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span> <span class="o">-</span> <span class="n">rest_samples</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">rest_samples</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">)))</span>
<span class="linenos">59</span>
<span class="linenos">60</span>     <span class="c1"># apply stride trick</span>
<span class="linenos">61</span>     <span class="n">frames</span> <span class="o">=</span> <span class="n">stride_trick</span><span class="p">(</span><span class="n">pad_signal</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_length</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">frame_step</span><span class="p">))</span>
<span class="linenos">62</span>     <span class="k">return</span> <span class="n">frames</span><span class="p">,</span> <span class="n">frame_length</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
<p>This blog presented framing, which is a fundamental signal processing technique to that divides a signal into multiple, equally sized, blocks.
The resulting blocks are considered stationary over time, which helps extract useful characterizing features of the signal.
This operation can be implemented in python in a classical fashion or using the stride trick for a fast processing.</p>
</section>
<section id="share-this-blog">
<h2>Share this blog<a class="headerlink" href="#share-this-blog" title="Permalink to this headline">#</a></h2>
<div id="share">
  <a class="facebook" href="https://www.facebook.com/share.php?u=https://superkogito.github.io/blog/2020/01/25/signal_framing.html&title=Signal%20framing"                target="blank"><i class="fa fa-facebook"></i></a>
  <a class="twitter"  href="https://twitter.com/intent/tweet?url=https://superkogito.github.io/blog/2020/01/25/signal_framing.html&text=Signal%20framing"                 target="blank"><i class="fa fa-twitter"></i></a>
  <a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://superkogito.github.io/blog/2020/01/25/signal_framing.html&title=Signal%20framing" target="blank"><i class="fa fa-linkedin"></i></a>
  <a class="reddit"   href="http://www.reddit.com/submit?url=https://superkogito.github.io/blog/2020/01/25/signal_framing.html&title=Signal%20framing"                    target="blank"><i class="fa fa-reddit"></i></a>
</div><div class="note update admonition">
<p class="admonition-title">Updated on 08 April 2022</p>
<p>üë®‚Äçüíª edited and review were on 08.04.202</p>
</div>
</section>
<section id="references-and-further-readings">
<h2>References and Further readings<a class="headerlink" href="#references-and-further-readings" title="Permalink to this headline">#</a></h2>
<div class="docutils container" id="id2">
<dl class="footnote brackets">
<dt class="label" id="footcite-deller"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>John¬†R. Deller, John¬†G. Proakis, and John¬†H. Hansen. <em>Discrete Time Processing of Speech Signals</em>. Prentice Hall PTR, USA, 1st edition, 1987. ISBN 0023283017.</p>
</dd>
</dl>
</div>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
     
    <a href="../../../../2019/06/30/diabetes_detection_using_machine_learning2/">
      <i class="fa fa-arrow-circle-left"></i> Diabetes detection using machine learning (part II)
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
     
    <a href="../../../02/09/naive_vad/">
      Naive voice activity detection using short time energy <i
        class="fa fa-arrow-circle-right"
      ></i
      >
    </a>
    
  </span>
</div>
  
</div>

            </article>
            
<!-- Add a comment box underneath the page's content -->
<script src="https://giscus.app/client.js"
        data-repo="superKogito/SuperKogito.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNTk5NjI3Mjg="
        data-category="Announcements"
        data-category-id="DIC_kwDOCYjWaM4CObax"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
<script src="../_static/cookiealert.js"></script>

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-framing">
   What is framing ?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-do-we-do-need-framing">
   Why do we do need framing?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-implement-it">
   How to implement it?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code">
     Code
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#share-this-blog">
   Share this blog
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-and-further-readings">
   References and Further readings
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../../../../../_sources/blog/2020/01/25/signal_framing.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2019-2022, Ayoub Malek.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>
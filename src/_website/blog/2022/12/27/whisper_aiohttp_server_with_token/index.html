
<!DOCTYPE html>

<html lang="english">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="Whisper based speech recognition server" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://superkogito.github.io/blog/2022/12/27/whisper_aiohttp_server_with_token/" />
<meta property="og:site_name" content="🧠 SuperKogito" />
<meta property="og:description" content="Whipser based speech recognition authenticated aiohttp server" />
<meta property="og:image" content="http://superkogito.github.io/_static/meta_images/whisper_server_with_token.png" />
<meta property="og:image:alt" content="whisper_server_with_token" />
<meta property="og:keywords" content="whisper, speech recognition, authentication, server, client, python, ayoub malek, blog post" />
<meta name="description" content="In the last blog post: Token authenticated aiohttp server, an authenticated aiohttp server was introduced. In this post, we build on top of the previous posts, to create an Automatic Speech Recognition (ASR) authenticated server, that uses the newly introduced whisper by OpenAI. Speech recognitio..." />
<meta property="og:ignore_canonical" content="true" />

    <title>Whisper based speech recognition server &#8212; 🧠 SuperKogito  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../../../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../../../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/twemoji.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/tree_graph.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/css/social_media_sharing.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/clipboard.min.js"></script>
    <script src="../../../../../_static/copybutton.js"></script>
    <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js"></script>
    <script src="../../../../../_static/twemoji.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'blog/2022/12/27/whisper_aiohttp_server_with_token';</script>
    <link rel="canonical" href="http://superkogito.github.io/blog/2022/12/27/whisper_aiohttp_server_with_token.html" />
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../../../about/" />
    <link rel="index" title="Index" href="../../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../../search/" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="english"> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../../../blog/atom.xml"
  title="SuperKogito"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../../../../search/" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../../../">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">🧠 SuperKogito  documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../projects/">
                        Projects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../">
                        Blog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../about/">
                        About Me
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        
<form class="bd-search d-flex align-items-center" action="../../../../../search/" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/superkogito/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../projects/">
                        Projects
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../">
                        Blog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../../../about/">
                        About Me
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        
<form class="bd-search d-flex align-items-center" action="../../../../../search/" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/superkogito/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">  
<h2>
   <i class="fa fa-calendar"></i>
  27 December 2022 
</h2>

<ul>
   
<li id="author">
  <span><i class="fa-fw fa fa-user"></i></span
  >
   
  <a href="../../../../author/ayoub-malek/">Ayoub Malek</a>  
</li>
 
<li id="location">
  <span><i class="fa-fw fa fa-location-arrow"></i></span
  >
   
  <a href="../../../../location/munich/">Munich</a>  
</li>
 
<li id="language">
  <span><i class="fa-fw fa fa-language"></i></span
  >
   
  <a href="../../../../language/english/">English</a>  
</li>
 
<li id="category">
  <span><i class="fa-fw fa fa-folder-open"></i></span
  >
   
  <a href="../../../../category/server-client/">Server-client</a>  
</li>
 
<li id="tags">
  <span><i class="fa-fw fa fa-tags"></i> </span
  >
   
  <a href="../../../../tag/whisper/">Whisper</a>   
  <a href="../../../../tag/server-client/">Server-client</a>   
  <a href="../../../../tag/speech-recognition/">Speech recognition</a>   
  <a href="../../../../tag/python/">Python</a>  
</li>
 
</ul>

    </div>
    <div class="sidebar-start-items__item">
<h3>
  <a href="../../../../">✍️ Recent Posts</a>
</h3>
<ul>
   
  <li>
    <a href="../../../../2021/12/31/aiohttp_server_with_token/"
      >Token authenticated aiohttp server</a>
      <p>31 December 2021</p>
  </li>
  
  <li>
    <a href="../../../../2021/12/31/aiohttp_server/"
      >Basic aiohttp server</a>
      <p>31 December 2021</p>
  </li>
  
  <li>
    <a href="../../../../2020/10/25/chmod_modes/"
      >Chmod modes: from symbolic to octal and back</a>
      <p>25 October 2020</p>
  </li>
  
  <li>
    <a href="../../../../2020/10/03/divide_image_using_gdiplus/"
      >Divide an image into blocks using GDI+ in C++</a>
      <p>03 October 2020</p>
  </li>
  
  <li>
    <a href="../../../../2020/10/01/divide_image_using_opencv/"
      >Divide an image into blocks using OpenCV in C++</a>
      <p>01 October 2020</p>
  </li>
  
</ul>

    </div>
    <div class="sidebar-start-items__item">
<h3>
  <a href="../../../../archive/">🗓️ Archives</a>
</h3>
<ul>
   
  <li>
    <a href="../../../">2022 (1)</a>
  </li>
    
  <li>
    <a href="../../../../2021/">2021 (2)</a>
  </li>
    
  <li>
    <a href="../../../../2020/">2020 (13)</a>
  </li>
    
  <li>
    <a href="../../../../2019/">2019 (7)</a>
  </li>
   
</ul>

    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            


<!--  Bootstrap HTML  -->
<div id="lawmsg" class="alert alert-info alert-dismissible h5 fade show fixed-bottom" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    We use cookies on this website to distinguish you from other users.
    We use this data to improve our content experience and for targeted advertising.
    By continuing to use this website you consent to our use of cookies.
    For more information, please see our
    <a href="https://superkogito.github.io/policy/cookies_policy.html" target="_blank">Cookie Policy</a>.
</div>



            <article class="bd-article" role="main">
               <section id="whisper-based-speech-recognition-server">
<h1>Whisper based speech recognition server<a class="headerlink" href="#whisper-based-speech-recognition-server" title="Permalink to this headline">#</a></h1>
<hr class="docutils" />
<p>In the last blog post: <a class="reference external" href="https://superkogito.github.io/blog/2021/12/31/aiohttp_server_with_token.html">Token authenticated aiohttp server</a>, an authenticated aiohttp server was introduced.
In this post, we build on top of the previous posts, to create an Automatic Speech Recognition (ASR) authenticated server, that uses the newly introduced <a class="reference external" href="https://github.com/openai/whisper">whisper</a> by <a class="reference external" href="https://openai.com/">OpenAI</a>.</p>
<section id="speech-recognition-implementation">
<h2>Speech recognition implementation<a class="headerlink" href="#speech-recognition-implementation" title="Permalink to this headline">#</a></h2>
<p>There are different approaches to implement this. The choice here is arbitrary, I chose whisper since it is accurate and simple to integrate.
One way to implement this is to use the whisper transcribe function. This can be done as follows:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">transcribe</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="kn">import</span> <span class="nn">io</span>
<span class="linenos"> 2</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 3</span> <span class="kn">import</span> <span class="nn">time</span>
<span class="linenos"> 4</span> <span class="kn">import</span> <span class="nn">asyncio</span>
<span class="linenos"> 5</span> <span class="kn">import</span> <span class="nn">logging</span>
<span class="linenos"> 6</span> <span class="kn">import</span> <span class="nn">whisper</span>
<span class="linenos"> 7</span> <span class="kn">import</span> <span class="nn">subprocess</span>
<span class="linenos"> 8</span> <span class="kn">import</span> <span class="nn">soundfile</span> <span class="k">as</span> <span class="nn">sf</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span> <span class="c1"># load model</span>
<span class="linenos">12</span> <span class="n">model</span> <span class="o">=</span> <span class="n">whisper</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;base&quot;</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span> <span class="k">async</span> <span class="k">def</span> <span class="nf">stt</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos">15</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">16</span><span class="sd">     Speech to text routine to transcribe incoming wave audio and deliver</span>
<span class="linenos">17</span><span class="sd">     the resulting text in return.</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="sd">     Args:</span>
<span class="linenos">20</span><span class="sd">         request.</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="sd">     Returns:</span>
<span class="linenos">23</span><span class="sd">         Json response.</span>
<span class="linenos">24</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="linenos">25</span>     <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">26</span>     <span class="n">stime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">27</span>     <span class="n">bytes_data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="linenos">28</span>     <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;size of received bytes data: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">bytes_data</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; bytes&quot;</span><span class="p">)</span>
<span class="linenos">29</span>
<span class="linenos">30</span>     <span class="k">try</span><span class="p">:</span>
<span class="linenos">31</span>         <span class="c1"># save temp file</span>
<span class="linenos">32</span>         <span class="n">audio</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">bytes_data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
<span class="linenos">33</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="n">audio</span><span class="o">=</span><span class="n">audio</span><span class="p">)</span>
<span class="linenos">34</span>         <span class="n">texts</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
<span class="linenos">35</span>         <span class="n">tproc</span>      <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">stime</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="linenos">36</span>         <span class="n">response</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">texts</span><span class="p">),</span> <span class="s2">&quot;proc_duration&quot;</span><span class="p">:</span> <span class="n">tproc</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">}</span>
<span class="linenos">37</span>
<span class="linenos">38</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos">39</span>         <span class="n">response</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;failed&quot;</span><span class="p">}</span>
<span class="linenos">40</span>         <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;-&gt; Errror :&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="linenos">41</span>
<span class="linenos">42</span>     <span class="k">return</span> <span class="n">web</span><span class="o">.</span><span class="n">json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="the-config">
<h2>The config<a class="headerlink" href="#the-config" title="Permalink to this headline">#</a></h2>
<p>We will be using the same config specified in <a class="reference external" href="https://superkogito.github.io/blog/2021/12/31/aiohttp_server_with_token.html#implementation">Token authenticated aiohttp server/config</a>
<em>Note the allowed_tokens sections, that can be replaced by your own server allowed tokens.</em></p>
</section>
<section id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">#</a></h2>
<p>The previously listed steps, should look together in Python as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kn">import</span> <span class="nn">io</span>
<span class="linenos">  2</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos">  3</span><span class="kn">import</span> <span class="nn">json</span>
<span class="linenos">  4</span><span class="kn">import</span> <span class="nn">time</span>
<span class="linenos">  5</span><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="linenos">  6</span><span class="kn">import</span> <span class="nn">logging</span>
<span class="linenos">  7</span><span class="kn">import</span> <span class="nn">whisper</span>
<span class="linenos">  8</span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="linenos">  9</span><span class="kn">import</span> <span class="nn">soundfile</span> <span class="k">as</span> <span class="nn">sf</span>
<span class="linenos"> 10</span><span class="kn">from</span> <span class="nn">aiohttp</span> <span class="kn">import</span> <span class="n">web</span>
<span class="linenos"> 11</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Coroutine</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="linenos"> 12</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="c1"># init loggging</span>
<span class="linenos"> 15</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="linenos"> 16</span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;[</span><span class="si">%(asctime)s</span><span class="s2">.</span><span class="si">%(msecs)03d</span><span class="s2">] p</span><span class="si">%(process)s</span><span class="s2"> {</span><span class="si">%(pathname)s</span><span class="s2">: </span><span class="si">%(funcName)s</span><span class="s2">: </span><span class="si">%(lineno)d</span><span class="s2">}: </span><span class="si">%(levelname)s</span><span class="s2">: </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %p %I:%M:%S&quot;</span><span class="p">)</span>
<span class="linenos"> 17</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span><span class="c1"># load model</span>
<span class="linenos"> 20</span><span class="n">model</span> <span class="o">=</span> <span class="n">whisper</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;base&quot;</span><span class="p">)</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="c1"># parse conf</span>
<span class="linenos"> 23</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">config_file</span><span class="p">:</span>
<span class="linenos"> 24</span>    <span class="n">conf</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">config_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span><span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos"> 27</span>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;-&gt; Received PING&quot;</span><span class="p">)</span>
<span class="linenos"> 28</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">json_response</span><span class="p">({</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;pong&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">})</span>
<span class="linenos"> 29</span>    <span class="k">return</span> <span class="n">response</span>
<span class="linenos"> 30</span>
<span class="linenos"> 31</span><span class="k">async</span> <span class="k">def</span> <span class="nf">stt</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="linenos"> 32</span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 33</span><span class="sd">    Speech to text routine to transcribe incoming wave audio and deliver</span>
<span class="linenos"> 34</span><span class="sd">    the resulting text in return.</span>
<span class="linenos"> 35</span>
<span class="linenos"> 36</span><span class="sd">    Args:</span>
<span class="linenos"> 37</span><span class="sd">        request.</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span><span class="sd">    Returns:</span>
<span class="linenos"> 40</span><span class="sd">        Json response.</span>
<span class="linenos"> 41</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 42</span>    <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos"> 43</span>    <span class="n">stime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos"> 44</span>    <span class="n">bytes_data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="linenos"> 45</span>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;size of received bytes data: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">bytes_data</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; bytes&quot;</span><span class="p">)</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span>    <span class="k">try</span><span class="p">:</span>
<span class="linenos"> 48</span>        <span class="c1"># save temp file</span>
<span class="linenos"> 49</span>        <span class="n">audio</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">bytes_data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
<span class="linenos"> 50</span>        <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="n">audio</span><span class="o">=</span><span class="n">audio</span><span class="p">)</span>
<span class="linenos"> 51</span>        <span class="n">texts</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
<span class="linenos"> 52</span>        <span class="n">tproc</span>      <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">stime</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="linenos"> 53</span>        <span class="n">response</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">texts</span><span class="p">),</span> <span class="s2">&quot;proc_duration&quot;</span><span class="p">:</span> <span class="n">tproc</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">}</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos"> 56</span>        <span class="n">response</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;failed&quot;</span><span class="p">}</span>
<span class="linenos"> 57</span>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;-&gt; Errror :&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span>    <span class="k">return</span> <span class="n">web</span><span class="o">.</span><span class="n">json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span><span class="k">def</span> <span class="nf">token_auth_middleware</span><span class="p">(</span><span class="n">user_loader</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<span class="linenos"> 62</span>                    <span class="n">request_property</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span>
<span class="linenos"> 63</span>                    <span class="n">auth_scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Token&#39;</span><span class="p">,</span>
<span class="linenos"> 64</span>                    <span class="n">exclude_routes</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(),</span>
<span class="linenos"> 65</span>                    <span class="n">exclude_methods</span><span class="p">:</span> <span class="n">Tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n">Coroutine</span><span class="p">:</span>
<span class="linenos"> 66</span>  <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 67</span><span class="sd">  Checks a auth token and adds a user from user_loader in request.</span>
<span class="linenos"> 68</span><span class="sd">  &quot;&quot;&quot;</span>
<span class="linenos"> 69</span>  <span class="nd">@web</span><span class="o">.</span><span class="n">middleware</span>
<span class="linenos"> 70</span>  <span class="k">async</span> <span class="k">def</span> <span class="nf">middleware</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">handler</span><span class="p">):</span>
<span class="linenos"> 71</span>      <span class="k">try</span>               <span class="p">:</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="linenos"> 72</span>      <span class="k">except</span> <span class="ne">KeyError</span>   <span class="p">:</span> <span class="k">raise</span> <span class="n">web</span><span class="o">.</span><span class="n">HTTPUnauthorized</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;Missing authorization header&#39;</span><span class="p">,)</span>
<span class="linenos"> 73</span>      <span class="k">except</span> <span class="ne">ValueError</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">web</span><span class="o">.</span><span class="n">HTTPForbidden</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;Invalid authorization header&#39;</span><span class="p">,)</span>
<span class="linenos"> 74</span>
<span class="linenos"> 75</span>      <span class="k">if</span> <span class="n">auth_scheme</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="n">scheme</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
<span class="linenos"> 76</span>          <span class="k">raise</span> <span class="n">web</span><span class="o">.</span><span class="n">HTTPForbidden</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;Invalid token scheme&#39;</span><span class="p">,)</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span>      <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">user_loader</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="linenos"> 79</span>      <span class="k">if</span> <span class="n">user</span> <span class="p">:</span> <span class="n">request</span><span class="p">[</span><span class="n">request_property</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
<span class="linenos"> 80</span>      <span class="k">else</span>    <span class="p">:</span> <span class="k">raise</span> <span class="n">web</span><span class="o">.</span><span class="n">HTTPForbidden</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="s1">&#39;Token doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="p">)</span>
<span class="linenos"> 81</span>      <span class="k">return</span> <span class="k">await</span> <span class="n">handler</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="linenos"> 82</span>  <span class="k">return</span> <span class="n">middleware</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span><span class="k">async</span> <span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
<span class="linenos"> 85</span>  <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 86</span><span class="sd">  Init web application.</span>
<span class="linenos"> 87</span><span class="sd">  &quot;&quot;&quot;</span>
<span class="linenos"> 88</span>  <span class="k">async</span> <span class="k">def</span> <span class="nf">user_loader</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="linenos"> 89</span>    <span class="n">user</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;uuid&#39;</span><span class="p">:</span> <span class="s1">&#39;fake-uuid&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">conf</span><span class="p">[</span><span class="s2">&quot;server&quot;</span><span class="p">][</span><span class="s2">&quot;http&quot;</span><span class="p">][</span><span class="s2">&quot;allowed_tokens&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
<span class="linenos"> 90</span>    <span class="k">return</span> <span class="n">user</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span>  <span class="n">app</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">(</span><span class="n">client_max_size</span><span class="o">=</span><span class="n">conf</span><span class="p">[</span><span class="s2">&quot;server&quot;</span><span class="p">][</span><span class="s2">&quot;http&quot;</span><span class="p">][</span><span class="s2">&quot;request_max_size&quot;</span><span class="p">],</span>
<span class="linenos"> 93</span>                <span class="n">middlewares</span><span class="o">=</span><span class="p">[</span><span class="n">token_auth_middleware</span><span class="p">(</span><span class="n">user_loader</span><span class="p">)])</span>
<span class="linenos"> 94</span>
<span class="linenos"> 95</span>  <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/ping&#39;</span><span class="p">,</span> <span class="n">ping</span><span class="p">)</span>
<span class="linenos"> 96</span>  <span class="n">app</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">add_route</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;/stt&#39;</span><span class="p">,</span> <span class="n">stt</span><span class="p">)</span>
<span class="linenos"> 97</span>  <span class="k">return</span> <span class="n">app</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="linenos">100</span>  <span class="n">web</span><span class="o">.</span><span class="n">run_app</span><span class="p">(</span><span class="n">init</span><span class="p">(),)</span>
</pre></div>
</div>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">#</a></h2>
<p>The previous code when executed will start a server running on <code class="code docutils literal notranslate"><span class="pre">http://localhost:8080/</span></code>.
To test your server, you can use <a class="reference external" href="https://curl.se/">curl</a>  <code class="code docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-H</span> <span class="pre">'Authorization:</span> <span class="pre">Token</span> <span class="pre">token1'</span> <span class="pre">http://localhost:8080/ping</span></code> (note that you will need to pass a token as specified in the config and code).
As for the transcription function, this can be tested by passing the audio file to transcribe using <code class="code docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-X</span> <span class="pre">POST</span> <span class="pre">--data-binary</span> <span class="pre">&#64;WAVEFILENAME.wav</span> <span class="pre">http://127.0.0.1:8080/stt</span></code>.</p>
<p>Alternatively, you can use <a class="reference external" href="https://www.postman.com/">Postman</a>, which is a tool for developers to design, build and test their APIs.
For this, you will need to create you GET request, specify the API/server link, add your wave file to transcribe to the body (as binary) and you will need to specify your token in the headers.
This can be done under the authorization tab, choose OAuth 2.0 as type, then set the &quot;Access Token&quot; to an allowed token (specify this in the config)
&quot;Header Prefix&quot; to Token (this is the same as defined in <code class="code docutils literal notranslate"><span class="pre">def</span> <span class="pre">token_auth_middleware(..</span> <span class="pre">auth_scheme:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'Token'..)</span></code>).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../../../../_images/postman-auth-config.png"><img alt="../../../../../_images/postman-auth-config.png" src="../../../../../_images/postman-auth-config.png" style="width: 756.0px; height: 312.5px;" /></a>
<figcaption>
<p><span class="caption-text">Figure 20: Postman authorization config</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The server reponses should look as follows:</p>
<ul class="simple">
<li><p>Ping response: {&quot;text&quot;: &quot;pong&quot;, &quot;status&quot;: &quot;success&quot;}</p></li>
<li><p>Stt response: {&quot;text&quot;: &quot;transcription&quot;, &quot;proc_duration&quot;: 0.xxx , &quot;status&quot;: &quot;success&quot;}</p></li>
</ul>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
<p>This blog built on top of the previous posts (<a class="reference external" href="https://superkogito.github.io/blog/2021/12/31/aiohttp_server_with_token.html">Basic aiohttp server</a> and <a class="reference external" href="https://superkogito.github.io/blog/2021/12/31/aiohttp_server_with_token.html">Token authenticated aiohttp server</a>) to deliver an ASR authenticated server based on <a class="reference external" href="https://github.com/openai/whisper">whisper</a>.</p>
</section>
<section id="share-this-blog">
<h2>Share this blog<a class="headerlink" href="#share-this-blog" title="Permalink to this headline">#</a></h2>
<div id="share">
  <a class="facebook" href="https://www.facebook.com/share.php?u=https://superkogito.github.io/blog/2022/12/27/whisper_aiohttp_server_with_token.html&title=whisper%20aiohttp%20server%20with%20token"                target="blank"><i class="fa fa-facebook"></i></a>
  <a class="twitter"  href="https://twitter.com/intent/tweet?url=https://superkogito.github.io/blog/2022/12/27/whisper_aiohttp_server_with_token.html&text=whisper%20aiohttp%20server%20with%20token"                 target="blank"><i class="fa fa-twitter"></i></a>
  <a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https://superkogito.github.io/blog/2022/12/27/whisper_aiohttp_server_with_token.html&title=whisper%20aiohttp%20server%20with%20token" target="blank"><i class="fa fa-linkedin"></i></a>
  <a class="reddit"   href="http://www.reddit.com/submit?url=https://superkogito.github.io/blog/2022/12/27/whisper_aiohttp_server_with_token.html&title=whisper%20aiohttp%20server%20with%20token"                    target="blank"><i class="fa fa-reddit"></i></a>
</div><div class="note update admonition">
<p class="admonition-title">Updated on 27 December 2022</p>
<p>👨‍💻 edited and review were on 27.12.2022</p>
</div>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
     
    <a href="../../../../2021/12/31/aiohttp_server_with_token/">
      <i class="fa fa-arrow-circle-left"></i> Token authenticated aiohttp server
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
    
  </span>
</div>
  
</div>

            </article>
            
<!-- Add a comment box underneath the page's content -->
<script src="https://giscus.app/client.js"
        data-repo="superKogito/SuperKogito.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNTk5NjI3Mjg="
        data-category="Announcements"
        data-category-id="DIC_kwDOCYjWaM4CObax"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
<script src="../_static/cookiealert.js"></script>

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#speech-recognition-implementation">
   Speech recognition implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-config">
   The config
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code">
   Code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing">
   Testing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#share-this-blog">
   Share this blog
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../../../../../_sources/blog/2022/12/27/whisper_aiohttp_server_with_token.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2019-2022, Ayoub Malek.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>
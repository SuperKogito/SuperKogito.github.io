
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/><meta content="applied machine learning to diabetics detection" name="description"/>
<meta content="machine learning, Pima, diabetes, scikit-learn, data processing, sklearn, classification, data scaling, knn, svc, gaussian, Ayoub Malek" name="keywords"/>
<meta content="Ayoub Malek" name="author"/>
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-133660046-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
<title>Diabetes detection using machine learning (part I) — Ayoub Malek's blog</title>
<link href="../_static/alabaster.css" rel="stylesheet" type="text/css"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom_style.css" rel="stylesheet" type="text/css"/>
<link href="../_static/css/code_style.css" rel="stylesheet" type="text/css"/>
<link href="../_static/css/tree_graph.css" rel="stylesheet" type="text/css"/>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js" type="text/javascript"></script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/language_data.js" type="text/javascript"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<link href="../_static/favicon.ico" rel="shortcut icon"/>
<link href="../about.html" rel="author" title="About these documents"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../_static/custom.css" rel="stylesheet" type="text/css"/>
<meta content="width=device-width, initial-scale=0.9, maximum-scale=0.9" name="viewport"/>
<style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/></head><body>
<div class="document">
<div class="documentwrapper">
<div class="body" role="main">
<div class="section" id="diabetes-detection-using-machine-learning-part-i">
<h1>Diabetes detection using machine learning (part I)<a class="headerlink" href="#diabetes-detection-using-machine-learning-part-i" title="Permalink to this headline">¶</a></h1>
<div class="sub-title-menu">
<table class="menu-table" id="menuTable" style="border:hidden;">
<tr>
<th>
<th>
<th class="icon"> <a href="../index.html" title="Home"><i class="fa fa-home"></i></a> </th>
<th class="menu-label"> <a href="../index.html" title="Home">Home</a> </th>
</th>
</th>
<th>
<th>
<th class="icon"><a href="../posts.html" title="Posts"><i class="fa fa-bars"></i></a></th>
<th class="menu-label"><a href="../posts.html" title="Posts">Posts</a></th>
</th>
</th>
<th>
<th>
<th class="icon"> <a href="../publications.html" title="pubs"><i class="fa fa-file-text"></i></a></th>
<th class="menu-label"> <a href="../publications.html" title="pubs">Publications</a></th>
</th>
</th>
<th>
<th>
<th class="icon"> <a href="../projects.html" title="projects"><i class="fa fa-code"></i></a></th>
<th class="menu-label"> <a href="../projects.html" title="projects">Projects</a></th>
</th>
</th>
<th>
<th>
<th class="icon"> <a href="../games.html" title="Games"><i class="fa fa-gamepad"></i></a></th>
<th class="menu-label"> <a href="../games.html" title="Games">Games</a></th>
</th>
</th>
<th>
<th>
<th class="icon"><a href="../about.html" title="About"><i class="fa fa-user-circle"></i></a></th>
<th class="menu-label"><a href="../about.html" title="About">About</a></th>
</th>
</th>
<th>
<th>
<th class="icon"> <a href="#" onclick="modeSwitcher()"><i class="fa fa-adjust"></i></a></th>
<th class="menu-label"> <a href="#" onclick="modeSwitcher()"><text id="theme-toggle">DARK MODE</text></a></th>
</th>
</th>
</tr>
</table>
</div>

<div class="blog-post-tags">
<ul class="blog-posts-details">
<li id="Date"><span>Date:</span>                 30 June 2019 </li>
<li id="author"><span>Author:</span> <a href="author/ayoub-malek.html">Ayoub Malek</a> </li>
<li id="location"><span>Location:</span> <a href="location/munich.html">Munich</a>
</li> <li id="language"><span>Language:</span> <a href="language/english.html">English</a>
</li> <li id="category"><span>Category:</span> <a href="category/machine-learning.html"> Machine learning</a>
</li>
<li id="tags"><span>Tags:
        </span>
<a class="post-tags" href="tag/data-processing.html">Data processing</a>
<a class="post-tags" href="tag/visualization.html">Visualization</a>
<a class="post-tags" href="tag/python.html">Python</a>
</li>
</ul>
</div><hr class="docutils"/>
<p>Diabetes is one of the most serious health challenges today.
The publicly available Pima Indian diabetic database (<a class="reference external" href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.names">PIDD</a>) have become a popular approach for testing the efficiency of machine learning algorithms <a class="footnote-reference brackets" href="#id6" id="id1">1</a>.
Within this context, this blog post is part of 2 posts providing an in depth introduction to diabetes detection using various machine learning approaches.
In this first post in particular, we focus on exploring the data at hand and preparing it for machine learning related processing.</p>
<ul>
<li>The dataset can be Downloaded from   <a href="https://github.com/SuperKogito/Diabetes-detection-using-machine-learning" title="vbgr"><i class="fa fa-database"></i>here</a>. </li>
<li> The code related to this blog can be found under <a href="https://github.com/SuperKogito/Diabetes-detection-using-machine-learning" title="vbgr"><i class="fa fa-github"></i> Diabetes detection</a>. </li>
<table align="center" style="width:100%">
<tr>
<th> <a aria-label="Watch SuperKogito/Diabetes-detection-using-machine-learning on GitHub" class="github-button" data-show-count="true" data-size="large" href="https://github.com/SuperKogito/Diabetes-detection-using-machine-learning/subscription">Watch</a> </th>
<th> <a aria-label="Star SuperKogito/Diabetes-detection-using-machine-learning on GitHub" class="github-button" data-show-count="true" data-size="large" href="https://github.com/SuperKogito/Diabetes-detection-using-machine-learning">Star</a></th>
<th> <a aria-label="Fork SuperKogito/Diabetes-detection-using-machine-learning on GitHub" class="github-button" data-show-count="true" data-size="large" href="https://github.com/SuperKogito/Diabetes-detection-using-machine-learning/fork">Fork</a> </th>
<th> <a aria-label="Download SuperKogito/Diabetes-detection-using-machine-learning on GitHub" class="github-button" data-size="large" href="https://github.com/SuperKogito/Diabetes-detection-using-machine-learning/archive/master.zip">Download</a></th>
<th> <a aria-label="Follow @SuperKogito on GitHub" class="github-button" data-show-count="true" data-size="large" href="https://github.com/SuperKogito">Follow @SuperKogito</a> </th>
</tr>
</table>
<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>
</ul><div class="section" id="the-pima-indian-diabetic-database">
<h2>The Pima Indian diabetic database<a class="headerlink" href="#the-pima-indian-diabetic-database" title="Permalink to this headline">¶</a></h2>
<p>The Pima Indian diabetes database (<a class="reference external" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database">Download_link</a>), donated from the <a class="reference external" href="https://www.niddk.nih.gov/">National_Institute_of_Diabetes_and_Digestive_and_Kidney_Diseases</a>, is a collection of medical diagnostic reports including information (9  numeric variables)
on 768 female patients (with ages between 21 and 81) of <a class="reference external" href="https://en.wikipedia.org/wiki/Pima_people">Pima</a> Indian heritage (a native American population living near Phoenix, Arizona, USA) <a class="footnote-reference brackets" href="#id7" id="id2">2</a>.
The database includes the following information <a class="footnote-reference brackets" href="#id8" id="id3">3</a> <a class="footnote-reference brackets" href="#id9" id="id4">4</a> :</p>
<ol class="arabic simple">
<li><p>Pregnancies: Number of times pregnant</p></li>
<li><p>Glucose: 2-Hour plasma glucose concentration in an oral glucose tolerance test</p></li>
<li><p>BloodPressure: Diastolic  blood  pressure (<span class="math notranslate nohighlight">\(mmHg\)</span>)</p></li>
<li><p>SkinThickness: Triceps skin fold thickness (<span class="math notranslate nohighlight">\(mm\)</span>)</p></li>
<li><p>Insulin: 2-Hour serum insulin (<span class="math notranslate nohighlight">\(\frac{\mu\text{U}}{ml}\)</span>)</p></li>
<li><p>BMI: Body mass index (BMI <span class="math notranslate nohighlight">\(\frac{weight~[kg]}{height^2~[m^2]}\)</span>)</p></li>
<li><p>DiabetesPedigreeFunction: Diabetes  pedigree  function</p></li>
<li><p>Age: Female age (<span class="math notranslate nohighlight">\(years\)</span>)</p></li>
<li><p>Outcome: Diabetes onset within 5 years (0 = No diabetes: green, 1 = diabetic: red).</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">The</span> <span class="n">goal</span> <span class="ow">is</span> <span class="n">to</span> <span class="n">predict</span> <span class="n">the</span> <span class="n">diabetic</span> <span class="n">diagnosis</span> <span class="p">(</span><span class="c1">#9) using the available 8 features (#1-#8).</span>
</pre></div>
</div>
<div class="section" id="data-exploration">
<h3>Data exploration<a class="headerlink" href="#data-exploration" title="Permalink to this headline">¶</a></h3>
<p>First, we start by loading our data and using <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html">pandas.DataFrame.describe</a> to get a nice description of the data at hand.</p>
<div class="literal-block-wrapper docutils container" id="code-snippet-i">
<div class="code-block-caption"><span class="caption-text">Code snippet I</span><a class="headerlink" href="#code-snippet-i" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="c1"># define column names</span>
<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Pregnancies"</span><span class="p">,</span>                <span class="s2">"Glucose"</span><span class="p">,</span> <span class="s2">"Blood_pressure"</span><span class="p">,</span>
               <span class="s2">"Skin_thickness"</span><span class="p">,</span>             <span class="s2">"Insulin"</span><span class="p">,</span> <span class="s2">"Bmi"</span><span class="p">,</span>
               <span class="s2">"Diabetes_Pedigree_Function"</span><span class="p">,</span> <span class="s2">"Age"</span><span class="p">,</span>     <span class="s2">"Outcome"</span><span class="p">]</span>
<span class="c1"># load data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'diabetes.csv'</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="output-i">
<div class="code-block-caption"><span class="caption-text">Output I</span><a class="headerlink" href="#output-i" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">Pregnancies</span>     <span class="n">Glucose</span>  <span class="n">Blood_pressure</span>  <span class="n">Skin_thickness</span>     <span class="n">Insulin</span>  \
 <span class="n">count</span>   <span class="mf">768.000000</span>  <span class="mf">768.000000</span>      <span class="mf">768.000000</span>      <span class="mf">768.000000</span>  <span class="mf">768.000000</span>
 <span class="n">mean</span>      <span class="mf">3.845052</span>  <span class="mf">120.894531</span>       <span class="mf">69.105469</span>       <span class="mf">20.536458</span>   <span class="mf">79.799479</span>
 <span class="n">std</span>       <span class="mf">3.369578</span>   <span class="mf">31.972618</span>       <span class="mf">19.355807</span>       <span class="mf">15.952218</span>  <span class="mf">115.244002</span>
 <span class="nb">min</span>       <span class="mf">0.000000</span>    <span class="mf">0.000000</span>        <span class="mf">0.000000</span>        <span class="mf">0.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">25</span><span class="o">%</span>       <span class="mf">1.000000</span>   <span class="mf">99.000000</span>       <span class="mf">62.000000</span>        <span class="mf">0.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">50</span><span class="o">%</span>       <span class="mf">3.000000</span>  <span class="mf">117.000000</span>       <span class="mf">72.000000</span>       <span class="mf">23.000000</span>   <span class="mf">30.500000</span>
 <span class="mi">75</span><span class="o">%</span>       <span class="mf">6.000000</span>  <span class="mf">140.250000</span>       <span class="mf">80.000000</span>       <span class="mf">32.000000</span>  <span class="mf">127.250000</span>
 <span class="nb">max</span>      <span class="mf">17.000000</span>  <span class="mf">199.000000</span>      <span class="mf">122.000000</span>       <span class="mf">99.000000</span>  <span class="mf">846.000000</span>

               <span class="n">Bmi</span>  <span class="n">Diabetes_Pedigree_Function</span>         <span class="n">Age</span>     <span class="n">Outcome</span>
 <span class="n">count</span>  <span class="mf">768.000000</span>                  <span class="mf">768.000000</span>  <span class="mf">768.000000</span>  <span class="mf">768.000000</span>
 <span class="n">mean</span>    <span class="mf">31.992578</span>                    <span class="mf">0.471876</span>   <span class="mf">33.240885</span>    <span class="mf">0.348958</span>
 <span class="n">std</span>      <span class="mf">7.884160</span>                    <span class="mf">0.331329</span>   <span class="mf">11.760232</span>    <span class="mf">0.476951</span>
 <span class="nb">min</span>      <span class="mf">0.000000</span>                    <span class="mf">0.078000</span>   <span class="mf">21.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">25</span><span class="o">%</span>     <span class="mf">27.300000</span>                    <span class="mf">0.243750</span>   <span class="mf">24.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">50</span><span class="o">%</span>     <span class="mf">32.000000</span>                    <span class="mf">0.372500</span>   <span class="mf">29.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">75</span><span class="o">%</span>     <span class="mf">36.600000</span>                    <span class="mf">0.626250</span>   <span class="mf">41.000000</span>    <span class="mf">1.000000</span>
 <span class="nb">max</span>     <span class="mf">67.100000</span>                    <span class="mf">2.420000</span>   <span class="mf">81.000000</span>    <span class="mf">1.000000</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="improving-data-quality">
<h3>Improving data quality<a class="headerlink" href="#improving-data-quality" title="Permalink to this headline">¶</a></h3>
<p>From the previous output help we can deduce that there are no missing values (all columns include 768 value).
However,  we notice some unrealistic values (it seems that someone replaced missing  values with zeros ) in the data <a class="footnote-reference brackets" href="#id6" id="id5">1</a>.
For example: a Bmi = 0 means that the person either has an infinite height or a zero weight, which is not physically possible.</p>
<p>These errors are summarized in the following:</p>
<ul class="simple">
<li><p>5   patients with a glucose of 0.</p></li>
<li><p>11  patients with a body mass index  of  0.</p></li>
<li><p>35  patients  with  a  diastolic  blood  pressure  of  0.</p></li>
<li><p>227 patients  with a skin  fold  thickness  readings  of  0.</p></li>
<li><p>374 patients  with  serum  insulin  levels  of  0.</p></li>
</ul>
<p>Although, these values can be reconstructed (using K-nearest neighbor algorithm assuming the data from patients with similar features follow the same pattern) but I opted for dropping rows including faulty data, which results in a database with only 392 case (no  missing  values).
The previous pre-processing is done using the following code:</p>
<div class="literal-block-wrapper docutils container" id="code-snippet-ii">
<div class="code-block-caption"><span class="caption-text">Code snippet II</span><a class="headerlink" href="#code-snippet-ii" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="k">def</span> <span class="nf">drop_column_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Delete certain dataframe rows based on the value of a certain column element</span>
<span class="sd">    '''</span>
    <span class="c1"># Get names of indexes for which column Age has value 30</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span> <span class="n">data</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span> <span class="p">]</span><span class="o">.</span><span class="n">index</span>

    <span class="c1"># Delete these row indexes from dataFrame</span>
    <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">indices</span> <span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="c1"># drop erroneous rows</span>
<span class="k">for</span> <span class="n">cname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'Glucose'</span><span class="p">,</span> <span class="s1">'Blood_pressure'</span><span class="p">,</span> <span class="s1">'Skin_thickness'</span><span class="p">,</span> <span class="s1">'Insulin'</span><span class="p">,</span> <span class="s1">'Bmi'</span><span class="p">]:</span>
    <span class="n">drop_column_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cname</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="output-ii">
<div class="code-block-caption"><span class="caption-text">Output II</span><a class="headerlink" href="#output-ii" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>        <span class="n">Pregnancies</span>     <span class="n">Glucose</span>  <span class="n">Blood_pressure</span>  <span class="n">Skin_thickness</span>     <span class="n">Insulin</span>  \
 <span class="n">count</span>   <span class="mf">392.000000</span>  <span class="mf">392.000000</span>      <span class="mf">392.000000</span>      <span class="mf">392.000000</span>  <span class="mf">392.000000</span>
 <span class="n">mean</span>      <span class="mf">3.301020</span>  <span class="mf">122.627551</span>       <span class="mf">70.663265</span>       <span class="mf">29.145408</span>  <span class="mf">156.056122</span>
 <span class="n">std</span>       <span class="mf">3.211424</span>   <span class="mf">30.860781</span>       <span class="mf">12.496092</span>       <span class="mf">10.516424</span>  <span class="mf">118.841690</span>
 <span class="nb">min</span>       <span class="mf">0.000000</span>   <span class="mf">56.000000</span>       <span class="mf">24.000000</span>        <span class="mf">7.000000</span>   <span class="mf">14.000000</span>
 <span class="mi">25</span><span class="o">%</span>       <span class="mf">1.000000</span>   <span class="mf">99.000000</span>       <span class="mf">62.000000</span>       <span class="mf">21.000000</span>   <span class="mf">76.750000</span>
 <span class="mi">50</span><span class="o">%</span>       <span class="mf">2.000000</span>  <span class="mf">119.000000</span>       <span class="mf">70.000000</span>       <span class="mf">29.000000</span>  <span class="mf">125.500000</span>
 <span class="mi">75</span><span class="o">%</span>       <span class="mf">5.000000</span>  <span class="mf">143.000000</span>       <span class="mf">78.000000</span>       <span class="mf">37.000000</span>  <span class="mf">190.000000</span>
 <span class="nb">max</span>      <span class="mf">17.000000</span>  <span class="mf">198.000000</span>      <span class="mf">110.000000</span>       <span class="mf">63.000000</span>  <span class="mf">846.000000</span>

               <span class="n">Bmi</span>  <span class="n">Diabetes_Pedigree_Function</span>         <span class="n">Age</span>     <span class="n">Outcome</span>
 <span class="n">mean</span>    <span class="mf">33.086224</span>                    <span class="mf">0.523046</span>   <span class="mf">30.864796</span>    <span class="mf">0.331633</span>
 <span class="n">std</span>      <span class="mf">7.027659</span>                    <span class="mf">0.345488</span>   <span class="mf">10.200777</span>    <span class="mf">0.471401</span>
 <span class="nb">min</span>     <span class="mf">18.200000</span>                    <span class="mf">0.085000</span>   <span class="mf">21.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">25</span><span class="o">%</span>     <span class="mf">28.400000</span>                    <span class="mf">0.269750</span>   <span class="mf">23.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">50</span><span class="o">%</span>     <span class="mf">33.200000</span>                    <span class="mf">0.449500</span>   <span class="mf">27.000000</span>    <span class="mf">0.000000</span>
 <span class="mi">75</span><span class="o">%</span>     <span class="mf">37.100000</span>                    <span class="mf">0.687000</span>   <span class="mf">36.000000</span>    <span class="mf">1.000000</span>
 <span class="nb">max</span>     <span class="mf">67.100000</span>                    <span class="mf">2.420000</span>   <span class="mf">81.000000</span>    <span class="mf">1.000000</span>
</pre></div>
</div>
</div>
<p>Now that only correct data values are available, we notice the presence of various outliers.
These outliers can result in faulty predictions later on. Therefore, we try to eliminate these outliers using the Z-statics.
Moreover, for the algorithm each column represents a feature and high variance and scaling difference can have a negative on the predictions.
Therefore, it is advised to scale the data, which will speed the system and improve its accuracy.
There are different ways of doing this, here I choose to first convert the Insulin values as they are way bigger than the others.
So instead of using (<span class="math notranslate nohighlight">\(\frac{\mu\text{U}}{ml}\)</span>), we convert to (<span class="math notranslate nohighlight">\(\frac{\text{nU}}{ml}\)</span>).
On top, we scale all the data and map it to a (0, 1) interval.
Finally, we notice that we have more samples describing the 0 outcome than samples for the 1 outcome.
This might result in better detection for the 0 outcome. To keep things balanced, I decide to equalize the dataset and use an equal number of samples for both cases.
In code this looks like the following:</p>
<div class="literal-block-wrapper docutils container" id="code-snippet-iii">
<div class="code-block-caption"><span class="caption-text">Code snippet III</span><a class="headerlink" href="#code-snippet-iii" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># plot raw data</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
                    <span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.35</span><span class="p">,</span> <span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Raw correct data'</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">vert</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">patch_artist</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="c1"># remove outliers and plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Data without outliers'</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">'Insulin'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Insulin'</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mo">001</span>
<span class="n">data</span>            <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">vert</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">patch_artist</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="c1"># scale data and plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span> <span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Scaled Data'</span><span class="p">)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">data</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>  <span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">vert</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">patch_artist</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="c1"># equilize data and plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Equilized Data'</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">equalize_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">vert</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">patch_artist</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The effects of the aforementioned transformations can be seen in the following box-plots (<a class="reference external" href="https://en.wikipedia.org/wiki/Box_plot">Box_plot</a>):</p>
<a class="reference internal image-reference" href="../_images/data_manipulations.png"><img alt="../_images/data_manipulations.png" class="align-center" src="../_images/data_manipulations.png" style="width: 1440.0px; height: 864.0px;"/></a>
<div class="clt">
<center><a href="../figures/fig7.html">Figure 7: Box-plots for data transformation </a> </center>
</div><div class="line-block">
<div class="line"><br/></div>
</div>
<p>We can also visualize the balance in the data using bar and pie plots as shown in the next figure.
These manipulations though improved the data but it also limited the dataset. The new dataset only includes 115x2 = 230 samples.</p>
<div class="literal-block-wrapper docutils container" id="code-snippet-iv">
<div class="code-block-caption"><span class="caption-text">Code snippet IV</span><a class="headerlink" href="#code-snippet-iv" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_overview</span><span class="p">(</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Plot Equalized samples overview</span>
<span class="sd">    '''</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Outcome</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">"Samples count and percentage based on outcome"</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mf">18.</span><span class="p">)</span>
    <span class="n">outcome</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rot</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'r'</span><span class="p">,</span> <span class="s1">'g'</span><span class="p">))</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Outcome = 0"</span><span class="p">,</span> <span class="s2">"Outcome = 1"</span><span class="p">])</span>
    <span class="n">outcome</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Outcome = 0"</span><span class="p">,</span> <span class="s2">"Outcome = 1"</span><span class="p">),</span>
                    <span class="n">autopct</span> <span class="o">=</span> <span class="s2">"</span><span class="si">%.2f%%</span><span class="s2">"</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mf">13.</span><span class="p">,</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">colors</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'r'</span><span class="p">,</span> <span class="s1">'g'</span><span class="p">),</span> <span class="n">wedgeprops</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"linewidth"</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s2">"edgecolor"</span><span class="p">:</span> <span class="s2">"#F7F7F7"</span><span class="p">})</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">"w"</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">"w"</span><span class="p">)</span>


<span class="n">plot_overview</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<a class="reference internal image-reference" href="../_images/samples_overview.png"><img alt="../_images/samples_overview.png" class="align-center" src="../_images/samples_overview.png" style="width: 576.0px; height: 576.0px;"/></a>
<div class="clt">
<center><a href="../figures/fig8.html">Figure 8: Data overview </a> </center>
</div><div class="line-block">
<div class="line"><br/></div>
</div>
<p>The previously discussed transformations are used to remove possible bias in the data and improve its quality.
However, if used improperly, it may deteriorate the detection quality. the question of which transformations to apply is dependent on the data nature, and the features correlation and distribution.</p>
</div>
<div class="section" id="features-overview">
<h3>Features overview<a class="headerlink" href="#features-overview" title="Permalink to this headline">¶</a></h3>
<p>Now that we cleaned the data, let us examine the available features closely. For that, we look at the bars and densities charts generated using DfPlotter.py (Github link to come later).
This should help build some intuitions and observations related to the features interactions.</p>
<a class="reference internal image-reference" href="../_images/bars.png"><img alt="../_images/bars.png" class="align-center" src="../_images/bars.png" style="width: 576.0px; height: 691.2px;"/></a>
<div class="clt">
<center><a href="../figures/fig9.html">Figure 9: Bar-plots for the different features </a> </center>
</div><a class="reference internal image-reference" href="../_images/densities.png"><img alt="../_images/densities.png" class="align-center" src="../_images/densities.png" style="width: 1152.0px; height: 864.0px;"/></a>
<div class="clt">
<center><a href="../figures/fig10.html">Figure 10: Densities of the different features </a> </center>
</div><div class="line-block">
<div class="line"><br/></div>
</div>
<p>From these plots alone, we can already confirm some known facts such as:</p>
<ul class="simple">
<li><p>With age the chances of having diabetes are higher.</p></li>
<li><p>With low responsiveness to insulin, the chances of diabetes are high.</p></li>
</ul>
</div>
<div class="section" id="correlation-and-features-selection">
<h3>Correlation and features selection<a class="headerlink" href="#correlation-and-features-selection" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Correlation_and_dependence">Correlation</a> is a numerical coefficient representing the dependence between two features.
It is a very useful metric, that helps rank the available features importance.
In many systems, not all the features are relevant or at least some are redundant and leaving them out is a better option for speed or even accuracy reasons.
Think of it as a similarity metric: if two features are highly correlated so they embody the same information and consequently you can drop one of them.
Using the DfPlotter.py (Github link to come later) script, we compute &amp; visualize the correlations matrix and the the pai-plots related to the data.</p>
<a class="reference internal image-reference" href="../_images/corr.png"><img alt="../_images/corr.png" class="align-center" src="../_images/corr.png" style="width: 828.0px; height: 828.0px;"/></a>
<div class="clt">
<center><a href="../figures/fig11.html">Figure 11: Correlation matrix </a> </center>
</div><div class="line-block">
<div class="line"><br/></div>
</div>
<p>When it comes to correlation coefficients:  bigger coefficient mean more dependence between the features.
The correlation’s matrix is a symmetric matrix with a diagonal of ones, since a feature/variable is totally correlated with itself.
In our example, we can conclude from the last row that the outcome is mostly dependent on the following features in order: Glucose (0.52), Insulin (0.38),  Age (0.38) and Bmi (0.28).
However, if we are settling only for 3 features; choosing the first 3 might not be the best option since Glucose and Insulin are highly correlated (0.59).
Therefore, a better choice would be to take:  Glucose (0.52), Age (0.38) and Bmi (0.28). This will be further discussed in [insert knn post name].</p>
<a class="reference internal image-reference" href="../_images/pairplot.png"><img alt="../_images/pairplot.png" class="align-center" src="../_images/pairplot.png" style="width: 838.5px; height: 803.0px;"/></a>
<div class="clt">
<center><a href="../figures/fig12.html">Figure 12: Distributions scatter-plots </a> </center>
</div><div class="line-block">
<div class="line"><br/></div>
</div>
<p>The pair plots confirm the previous results, since the only curves with some separation between data points are in the Glucose row, in particular the ones on the columns of the Skin_thickness and the Bmi.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This 1st plot from a series of 3 provided an elaborate explanation of data manipulation techniques, their use and reasons to use them.
From the raw dataset we retrieve a balanced, scaled and correct number of samples, that we later explored the mechanics regulating its features.
We will explore all these results to build a robust detection system in the next post.</p>
</div>
<div class="section" id="references-and-further-readings">
<h2>References and Further readings<a class="headerlink" href="#references-and-further-readings" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><p>Rahmat Zolfaghari, Diagnosis of Diabetes in Female Population of Pima Indian Heritage with Ensemble of BP Neural Network and SVM, IJCEM International Journal of Computational Engineering &amp; Management, Vol. 15 Issue 4, July 2012, <a class="reference external" href="https://www.ijcem.org/papers072012/ijcem_072012_22.pdf">paper</a></p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Pima Indians Diabetes Database, <a class="reference external" href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.names">PIMA_DB</a></p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Igor Shvartser, Jason Brownlee, Case Study: Predicting the Onset of Diabetes Within Five Years (part 1 of 3), March 2014, <a class="reference external" href="https://machinelearningmastery.com/case-study-predicting-the-onset-of-diabetes-within-five-years-part-1-of-3/">case_study_predicting_the_onset_of_diabetes_within_five_years_part_1_of_3</a></p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Kaggle, Pima Indians Diabetes Database: Predict the onset of diabetes based on diagnostic measures, <a class="reference external" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database">https://www.kaggle.com/uciml/pima-indians-diabetes-database</a></p>
</dd>
<dt class="label" id="id10"><span class="brackets">5</span></dt>
<dd><p>Kaggle kernals, Pima Indians Diabetes Database: Predict the onset of diabetes based on diagnostic measures, <a class="reference external" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database/kernels">https://www.kaggle.com/uciml/pima-indians-diabetes-database/kernels</a></p>
</dd>
</dl>
</div>
</div>
<div class="section">
<div class="section">
<span style="float: left;">
  
  Previous: 
  <a href="VoiceBasedGenderRecognition.html">
    
    Voice based gender recognition using Gaussian mixture models
  </a>
</span>
<span> </span>
<span style="float: right;">
  
  Next: 
  <a href="diabetesML2.html">
    Diabetes detection using machine learning (part II)
    
  </a>
</span>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="footer">
      ©2020, Ayoub Malek.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../_sources/blog/diabetesML1.rst.txt" rel="nofollow">Page source</a>
</div><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><script src="../_static/js/mode-switcher.js"></script>
</body>
</html>